import{a as fe}from"./chunk-4DCX2U46.js";import{a as Ce}from"./chunk-POMG26IM.js";import{a as L}from"./chunk-JETGV2KU.js";import{a as te,b as ie}from"./chunk-3EDIKQYL.js";import{B as Y,D as Q,E as X,H as J,I as K,J as Z,L as $,M as ee,O as V,c as U,d as H,l as q,t as j,w as z}from"./chunk-4QEBWWP4.js";import{k as G,l as P,m as ue,r as ge,u as O}from"./chunk-3BZESKLL.js";import{Cb as _,Eb as _e,Fc as B,Mb as n,Nb as a,Ob as I,Sb as x,Yb as u,Zb as l,a as A,b as E,ca as R,db as s,e as pe,ha as F,hc as d,ic as w,jb as D,jc as h,mc as g,nc as C,oc as f,pb as T,qa as m,ra as p,rc as W,ub as y,vc as le,xc as ce}from"./chunk-NIELWWGW.js";var ne=pe(Ce());var N=class c extends ie{endpoint=te.apiUrl+"/ImportCompras/proteccionMarcas/crearact/";constructor(i){super(i)}getUserSessionToken(){return localStorage.getItem("authToken")||localStorage.getItem("token")||""}getUserSessionData(){let i=localStorage.getItem("user")||"",e=null;try{i&&(e=JSON.parse(i))}catch{e=i}return e}headers=new U({"Content-Type":"application/json",Authorization:`Bearer ${this.getUserSessionToken()}`});Guardar_datos(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Guardar_datos",i,{headers:this.headers})}Cargar_Tipos_Marcas(){return this.http.post(this.endpoint+"Cargar_Tipos_Marcas",{headers:this.headers})}Cargar_Marcas(i){return this.http.post(this.endpoint+"Cargar_Marcas",i,{headers:this.headers})}static \u0275fac=function(e){return new(e||c)(F(H))};static \u0275prov=R({token:c,factory:c.\u0275fac,providedIn:"root"})};function xe(c,i){if(c&1&&(n(0,"option",33),d(1),a()),c&2){let e=i.$implicit;_("ngValue",e.id),s(),h(" ",e.nombre," ")}}function ye(c,i){if(c&1&&(n(0,"option",33),d(1),a()),c&2){let e=i.$implicit;_("ngValue",e),s(),h(" ",e.Nombre," ")}}var ae=class c{constructor(i,e,o){this.service=i;this.cdr=e;this.router=o}marca=null;tipos=[];marcas=[];maxDate="";modoCheck="marca";form={tipo:"",marca:{},referencia:"",fecha:"",periodo:"",concepto:"",valor:0,fechaActividad:"",check_marca:this.modoCheck==="marca"?0:1};ngOnInit(){this.maxDate=new Date().toISOString().split("T")[0],this.Cargar_Tipos_Marcas(),this.Cargar_Marcas()}onCheckMarcaChange(){this.Cargar_Marcas()}mostrarAlerta(i){ne.default.fire({icon:"error",title:"Error de validaci\xF3n",text:`El campo "${i}" es obligatorio.`,confirmButtonText:"Aceptar"})}Guardar_datos(){let i=o=>o==null||typeof o=="string"&&o.trim()==="";if(i(this.form.fechaActividad)){this.mostrarAlerta("Fecha de Actividad");return}if(i(this.form.tipo)){this.mostrarAlerta("Tipo");return}if(i(this.form.marca?.ID)){let o=this.modoCheck==="marca"?"Marca":"Proveedor";this.mostrarAlerta(o);return}if(i(this.form.referencia)){this.mostrarAlerta("Referencia");return}if(i(this.form.periodo)){this.mostrarAlerta("Periodo");return}if(this.form.valor===null||this.form.valor<=0){this.mostrarAlerta("Valor");return}if(i(this.form.concepto)){this.mostrarAlerta("Concepto");return}let e={Tipo:this.form.tipo,MarcaID:this.form.marca?.ID,MarcaNombre:this.form.marca?.Nombre,Referencia:this.form.referencia,Periodo:this.form.periodo,Concepto:this.form.concepto,valor:this.form.valor,Fecha_actividad:this.form.fechaActividad,Cheek_marca:this.form.check_marca};this.service.Guardar_datos(e).subscribe({next:o=>{if(console.log(o),!o.success){ne.default.fire("Error","No se pudo guardar la actividad","error");return}ne.default.fire("\xC9xito","Actividad guardada correctamente","success"),this.Limpiar_campos()}})}Limpiar_campos(){this.form={tipo:"",marca:null,referencia:"",fecha:"",periodo:"",concepto:"",valor:0,fechaActividad:"",check_marca:this.modoCheck==="marca"?0:1},this.cdr.detectChanges()}Cargar_Tipos_Marcas(){this.service.Cargar_Tipos_Marcas().subscribe({next:i=>{i.success&&(this.tipos=i.data)}})}Cargar_Marcas(){let i={marca:this.modoCheck==="marca"?0:1};this.service.Cargar_Marcas(i).subscribe({next:e=>{e.success&&(this.marcas=e.data)}})}static \u0275fac=function(e){return new(e||c)(D(N),D(B),D(q))};static \u0275cmp=T({type:c,selectors:[["app-crearact"]],decls:74,vars:16,consts:[[1,"container-fluid","customer-order-wrapper"],[1,"row"],[1,"col-12"],[3,"headerTitle","cardClass"],[1,"col-md-7"],[1,"mb-3"],[1,"form-label"],["type","date","id","Fecha_actividad","required","",1,"form-control",3,"ngModelChange","ngModel","max"],[1,"text-danger"],["id","Tipo","required","",1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-check"],["type","radio","id","check_Marca",1,"form-check-input",3,"ngModelChange","value","ngModel"],[1,"fst-italic"],["type","radio",1,"form-check-input",3,"ngModelChange","value","ngModel"],[1,"card","shadow-bg","border-0"],[1,"card-body"],[1,"col-md-6"],["id","Marca","required","",1,"form-select",3,"ngModelChange","ngModel"],["value","","selected",""],[1,"input-group"],[1,"input-group-text"],["type","number","id","Valor","placeholder","0.00","required","","min","0",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","xxxxxxxxxx","id","Referencia","required","",1,"form-control",3,"ngModelChange","ngModel"],["id","Periodo","required","",1,"form-select",3,"ngModelChange","ngModel"],["value","1"],["value","2"],["value","3"],["value","4"],["type","text","placeholder","Concepto","id","Concepto","required","","rows","3",1,"form-control",3,"ngModelChange","ngModel"],[1,"mt-3"],["id","Ingresar",1,"btn","btn-primary",3,"click"],[3,"ngValue"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-card",3)(4,"div",4)(5,"div",5)(6,"label",6),d(7,"Fecha de Actividad"),a(),n(8,"input",7),f("ngModelChange",function(r){return C(o.form.fechaActividad,r)||(o.form.fechaActividad=r),r}),a()(),n(9,"div",5)(10,"label",6),d(11,"Tipo "),n(12,"span",8),d(13,"*"),a()(),n(14,"select",9),f("ngModelChange",function(r){return C(o.form.tipo,r)||(o.form.tipo=r),r}),n(15,"option",10),d(16,"Seleccione"),a(),y(17,xe,2,2,"option",11),a()(),n(18,"div",12)(19,"input",13),f("ngModelChange",function(r){return C(o.modoCheck,r)||(o.modoCheck=r),r}),u("ngModelChange",function(){return o.onCheckMarcaChange()}),a(),n(20,"label",14),d(21,"Marca"),a()(),n(22,"div",12)(23,"input",15),f("ngModelChange",function(r){return C(o.modoCheck,r)||(o.modoCheck=r),r}),u("ngModelChange",function(){return o.onCheckMarcaChange()}),a(),n(24,"label",14),d(25,"Proveedor"),a()(),n(26,"div",16)(27,"div",17)(28,"div",1)(29,"div",18)(30,"div",5)(31,"label",6),d(32,"Marca"),a(),n(33,"select",19),f("ngModelChange",function(r){return C(o.form.marca,r)||(o.form.marca=r),r}),n(34,"option",20),d(35,"Seleccione"),a(),y(36,ye,2,2,"option",11),a()(),n(37,"div",5)(38,"label",6),d(39,"Valor"),a(),n(40,"div",21)(41,"span",22),d(42,"$"),a(),n(43,"input",23),f("ngModelChange",function(r){return C(o.form.valor,r)||(o.form.valor=r),r}),a()()()(),n(44,"div",18)(45,"div",5)(46,"label",6),d(47,"Referencia"),a(),n(48,"div",21)(49,"span",22),d(50,"#"),a(),n(51,"input",24),f("ngModelChange",function(r){return C(o.form.referencia,r)||(o.form.referencia=r),r}),a()()(),n(52,"div",5)(53,"label",6),d(54,"Periodo"),a(),n(55,"select",25),f("ngModelChange",function(r){return C(o.form.periodo,r)||(o.form.periodo=r),r}),n(56,"option",20),d(57,"Seleccione"),a(),n(58,"option",26),d(59,"1 Q "),a(),n(60,"option",27),d(61,"2 Q"),a(),n(62,"option",28),d(63,"3 Q"),a(),n(64,"option",29),d(65,"4 Q"),a()()()()(),n(66,"div",5)(67,"label",6),d(68,"Concepto"),a(),n(69,"div",21)(70,"textarea",30),f("ngModelChange",function(r){return C(o.form.concepto,r)||(o.form.concepto=r),r}),a()()(),n(71,"div",31)(72,"button",32),u("click",function(){return o.Guardar_datos()}),d(73," Ingresar Actividad "),a()()()()()()()()()),e&2&&(s(3),_("headerTitle","Ingreso de Actividad")("cardClass","mb-4"),s(5),g("ngModel",o.form.fechaActividad),_("max",o.maxDate),s(6),g("ngModel",o.form.tipo),s(3),_("ngForOf",o.tipos),s(2),_("value","marca"),g("ngModel",o.modoCheck),s(4),_("value","proveedor"),g("ngModel",o.modoCheck),s(10),g("ngModel",o.form.marca),s(3),_("ngForOf",o.marcas),s(7),g("ngModel",o.form.valor),s(8),g("ngModel",o.form.referencia),s(4),g("ngModel",o.form.periodo),s(15),g("ngModel",o.form.concepto))},dependencies:[O,P,V,K,Z,j,Q,J,X,z,ee,$,Y,L],encapsulation:2})};var v=pe(Ce());var re=class c extends ie{endpoint=te.apiUrl+"/ImportCompras/proteccionMarcas/listact/";constructor(i){super(i)}getUserSessionToken(){return localStorage.getItem("authToken")||localStorage.getItem("token")||""}getUserSessionData(){let i=localStorage.getItem("user")||"",e=null;try{i&&(e=JSON.parse(i))}catch{e=i}return e}headers=new U({"Content-Type":"application/json",Authorization:`Bearer ${this.getUserSessionToken()}`});marca_creada(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"marca_creada",i,{headers:this.headers})}Cargar_Actividades_por_Consolidado(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Cargar_Actividades_por_Consolidado",i,{headers:this.headers})}Cargar_Gastos_Por_Consolidado(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Cargar_Gastos_Por_Consolidado",i,{headers:this.headers})}Actividades_Individuales(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Actividades_Individuales",i,{headers:this.headers})}marca_creada2(){return this.http.post(this.endpoint+"marca_creada2",{headers:this.headers})}Facturas_marcas(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Facturas_marcas",i,{headers:this.headers})}Actualizar_actividad(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Actualizar_actividad",i,{headers:this.headers})}Cargar_Tipos_Marcas(){return this.http.post(this.endpoint+"Cargar_Tipos_Marcas",{headers:this.headers})}Cargar_Marcas_Editar(){return this.http.post(this.endpoint+"Cargar_Marcas_Editar",{headers:this.headers})}Buscar_Proteccion(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Buscar_Proteccion",i,{headers:this.headers})}Consolidar_Actividades(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Consolidar_Actividades",i,{headers:this.headers})}GUARDAR_DATOS(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"GUARDAR_DATOS",i,{headers:this.headers})}GUARDAR_NOTA_CREDITO(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"GUARDAR_NOTA_CREDITO",i,{headers:this.headers})}Eliminar_Actividad(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Eliminar_Actividad",i,{headers:this.headers})}Eliminar_actividad_creada(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Eliminar_actividad_creada",i,{headers:this.headers})}Buscar_Documentos(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Buscar_Documentos",i,{headers:this.headers})}Validar_Pagos(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Validar_Pagos",i,{headers:this.headers})}Agregar_Pago(i){return i.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"Agregar_Pago",i,{headers:this.headers})}static \u0275fac=function(e){return new(e||c)(F(H))};static \u0275prov=R({token:c,factory:c.\u0275fac,providedIn:"root"})};function we(c,i){if(c&1){let e=x();n(0,"div")(1,"div",18)(2,"label",19),d(3,"Actividades Individuales"),a(),n(4,"div",20)(5,"label",21),d(6,"Cantidad: ..."),a(),n(7,"div",22)(8,"app-table",23),u("action",function(t){m(e);let r=l();return p(r.onActAction(t))}),a()()()()()}if(c&2){let e=l();s(8),_("tableConfig",e.ActividadesTableConfig)("pageSize",10)("paginateDetails",!0)("selectedRows",!1)("downloadReports",!0)("exportButtons",e.Buttons_Export)}}function Me(c,i){if(c&1){let e=x();n(0,"div")(1,"div",1)(2,"div",8)(3,"label",27),d(4,"Detalles:"),a(),n(5,"div",28)(6,"div",29),d(7,"DETALLE:"),a(),n(8,"div",30),d(9),a()(),n(10,"div",28)(11,"div",29),d(12,"VALOR:"),a(),n(13,"div",30),d(14),a()(),n(15,"div",28)(16,"div",29),d(17,"SALDO:"),a(),n(18,"div",30),d(19),a()()(),n(20,"div",31)(21,"h1",32),d(22,"Asignar Pago"),a(),n(23,"div",9)(24,"label",10),d(25,"Detalle / Numero de Documento"),a(),n(26,"div",33)(27,"input",34),f("ngModelChange",function(t){m(e);let r=l(3);return C(r.formAsignPago.documento,t)||(r.formAsignPago.documento=t),p(t)}),a(),n(28,"div",35)(29,"button",36),u("click",function(){m(e);let t=l(3);return p(t.Validar_Pago())}),d(30," Validar "),a()()()(),n(31,"div",9)(32,"label",10),d(33,"Valor a Pagar:"),a(),n(34,"div",33)(35,"input",37),f("ngModelChange",function(t){m(e);let r=l(3);return C(r.formAsignPago.valor,t)||(r.formAsignPago.valor=t),p(t)}),a(),n(36,"div",35)(37,"button",38),u("click",function(){m(e);let t=l(3);return p(t.Agregar_Pago())}),d(38," Agregar "),a()()()()()()()}if(c&2){let e=l(3);s(9),h("",e.formAsignPago.detalledt," "),s(5),w(e.formAsignPago.valordt),s(5),w(e.formAsignPago.saldodt),s(8),g("ngModel",e.formAsignPago.documento),s(8),g("ngModel",e.formAsignPago.valor),_("disabled",!0)}}function Te(c,i){if(c&1){let e=x();n(0,"div")(1,"div",1)(2,"div",39)(3,"div",9)(4,"label",27),d(5,"Empresa:"),a(),n(6,"div",40)(7,"input",41),f("ngModelChange",function(t){m(e);let r=l(3);return C(r.formAsignPago.empresa,t)||(r.formAsignPago.empresa=t),p(t)}),a(),n(8,"label",42),d(9,"Cartimex"),a()(),n(10,"div",40)(11,"input",43),f("ngModelChange",function(t){m(e);let r=l(3);return C(r.formAsignPago.empresa,t)||(r.formAsignPago.empresa=t),p(t)}),a(),n(12,"label",44),d(13,"Computron"),a()()()(),n(14,"div",45)(15,"div",9)(16,"label",27),d(17,"Tipo Documento:"),a(),n(18,"div",40)(19,"input",46),f("ngModelChange",function(t){m(e);let r=l(3);return C(r.formAsignPago.documentoTipo,t)||(r.formAsignPago.documentoTipo=t),p(t)}),a(),n(20,"label",47),d(21,"BAN-DP"),a()(),n(22,"div",40)(23,"input",48),f("ngModelChange",function(t){m(e);let r=l(3);return C(r.formAsignPago.documentoTipo,t)||(r.formAsignPago.documentoTipo=t),p(t)}),a(),n(24,"label",49),d(25,"BAN-ND"),a()(),n(26,"div",40)(27,"input",50),f("ngModelChange",function(t){m(e);let r=l(3);return C(r.formAsignPago.documentoTipo,t)||(r.formAsignPago.documentoTipo=t),p(t)}),a(),n(28,"label",51),d(29,"BAN-IN"),a()()()(),n(30,"div",52)(31,"label",27),d(32,"Detalles:"),a(),n(33,"div",28)(34,"div",29),d(35,"DETALLE:"),a(),n(36,"div",30),d(37),a()(),n(38,"div",28)(39,"div",29),d(40,"VALOR:"),a(),n(41,"div",30),d(42),a()(),n(43,"div",28)(44,"div",29),d(45,"SALDO:"),a(),n(46,"div",30),d(47),a()()(),n(48,"div",31)(49,"h1",32),d(50,"Asignar Pago"),a(),n(51,"div",9)(52,"label",10),d(53,"Detalle / Numero de Documento"),a(),n(54,"div",33)(55,"input",34),f("ngModelChange",function(t){m(e);let r=l(3);return C(r.formAsignPago.documento,t)||(r.formAsignPago.documento=t),p(t)}),a(),n(56,"div",35)(57,"button",36),u("click",function(){m(e);let t=l(3);return p(t.Validar_Pago())}),d(58," Validar "),a()()()(),n(59,"div",9)(60,"label",10),d(61,"Valor a Pagar:"),a(),n(62,"div",33)(63,"input",37),f("ngModelChange",function(t){m(e);let r=l(3);return C(r.formAsignPago.valor,t)||(r.formAsignPago.valor=t),p(t)}),a(),n(64,"div",35)(65,"button",38),u("click",function(){m(e);let t=l(3);return p(t.Agregar_Pago())}),d(66," Agregar "),a()()()()()()()}if(c&2){let e=l(3);s(7),g("ngModel",e.formAsignPago.empresa),_("value","CARTIMEX"),s(4),g("ngModel",e.formAsignPago.empresa),_("value","COMPUTRONSA"),s(8),g("ngModel",e.formAsignPago.documentoTipo),_("value","BAN-DP"),s(4),g("ngModel",e.formAsignPago.documentoTipo),_("value","BAN-ND"),s(4),g("ngModel",e.formAsignPago.documentoTipo),_("value","BAN-IN"),s(10),h("",e.formAsignPago.detalledt," "),s(5),w(e.formAsignPago.valordt),s(5),w(e.formAsignPago.saldodt),s(8),g("ngModel",e.formAsignPago.documento),s(8),g("ngModel",e.formAsignPago.valor),_("disabled",!0)}}function Ie(c,i){if(c&1){let e=x();n(0,"div")(1,"div",25)(2,"div",15)(3,"div",9)(4,"button",26),u("click",function(){m(e);let t=l(2);return p(t.tooglePayNotaCredito())}),d(5,"Nota de Credito"),a()(),n(6,"div",9)(7,"button",26),u("click",function(){m(e);let t=l(2);return p(t.tooglePayIngreso())}),d(8,"Ingreso"),a()()()(),y(9,Me,39,6,"div",17)(10,Te,67,16,"div",17),a()}if(c&2){let e=l(2);s(4),_("ngClass",e.showPayNotaCredito?"btn-success":"btn-light"),s(3),_("ngClass",e.showPayIngreso?"btn-success":"btn-light"),s(2),_("ngIf",e.showPayNotaCredito),s(),_("ngIf",e.showPayIngreso)}}function Pe(c,i){if(c&1){let e=x();n(0,"div")(1,"div",18)(2,"label",19),d(3,"Actividades Consolidadas"),a(),n(4,"div",20)(5,"label",21),d(6,"Cantidad: ..."),a(),y(7,Ie,11,4,"div",17),n(8,"div",22)(9,"app-table",24),u("action",function(t){m(e);let r=l();return p(r.onListAction(t))})("customAction",function(t){m(e);let r=l();return p(r.onListConsAction(t))})("selectedRowsChange",function(t){m(e);let r=l();return p(r.onRowsSelected(t))}),a()()()()()}if(c&2){let e=l();s(7),_("ngIf",e.showPayConsolidado),s(2),_("tableConfig",e.ConsolidadosTableConfig)("pageSize",10)("paginateDetails",!0)("selectedRows",!0)("customButtons",e.consolidadosButtons)}}function Oe(c,i){if(c&1&&(n(0,"option",86),d(1),a()),c&2){let e=i.$implicit;_("ngValue",e.id),s(),h(" ",e.nombre," ")}}function Ve(c,i){if(c&1&&(n(0,"option",86),d(1),a()),c&2){let e=i.$implicit;_("ngValue",e),s(),h(" ",e.Nombre," ")}}function Le(c,i){if(c&1){let e=x();n(0,"div")(1,"div",53),u("click",function(){m(e);let t=l();return p(t.cerrarModalEditAct())}),a(),n(2,"div",54)(3,"div",55)(4,"div",56)(5,"div",57)(6,"h5",58),d(7,"Editar Actividad"),a(),n(8,"button",59),u("click",function(){m(e);let t=l();return p(t.cerrarModalEditAct())}),a()(),n(9,"div",60)(10,"div",61)(11,"div",9)(12,"label",10),d(13,"Fecha de Actividad"),a(),n(14,"input",62),f("ngModelChange",function(t){m(e);let r=l();return C(r.formEdit.fechaActividad,t)||(r.formEdit.fechaActividad=t),p(t)}),a()(),n(15,"div",9)(16,"label",10),d(17,"Tipo "),n(18,"span",63),d(19,"*"),a()(),n(20,"select",64),f("ngModelChange",function(t){m(e);let r=l();return C(r.formEdit.tipo,t)||(r.formEdit.tipo=t),p(t)}),n(21,"option",65),d(22,"Seleccione"),a(),y(23,Oe,2,2,"option",66),a()(),n(24,"div",40)(25,"input",67),f("ngModelChange",function(t){m(e);let r=l();return C(r.modoCheck,t)||(r.modoCheck=t),p(t)}),u("ngModelChange",function(){m(e);let t=l();return p(t.onCheckMarcaChange())}),a(),n(26,"label",68),d(27,"Marca"),a()(),n(28,"div",40)(29,"input",69),f("ngModelChange",function(t){m(e);let r=l();return C(r.modoCheck,t)||(r.modoCheck=t),p(t)}),u("ngModelChange",function(){m(e);let t=l();return p(t.onCheckMarcaChange())}),a(),n(30,"label",68),d(31,"Proveedor"),a()(),n(32,"div",5)(33,"div",6)(34,"div",1)(35,"div",70)(36,"div",9)(37,"label",10),d(38,"Marca"),a(),n(39,"select",71),f("ngModelChange",function(t){m(e);let r=l();return C(r.formEdit.marca,t)||(r.formEdit.marca=t),p(t)}),n(40,"option",72),d(41,"Seleccione"),a(),y(42,Ve,2,2,"option",66),a()(),n(43,"div",9)(44,"label",10),d(45,"Valor"),a(),n(46,"div",33)(47,"span",73),d(48,"$"),a(),n(49,"input",74),f("ngModelChange",function(t){m(e);let r=l();return C(r.formEdit.valor,t)||(r.formEdit.valor=t),p(t)}),a()()()(),n(50,"div",70)(51,"div",9)(52,"label",10),d(53,"Referencia"),a(),n(54,"div",33)(55,"span",73),d(56,"#"),a(),n(57,"input",75),f("ngModelChange",function(t){m(e);let r=l();return C(r.formEdit.referencia,t)||(r.formEdit.referencia=t),p(t)}),a()()(),n(58,"div",9)(59,"label",10),d(60,"Periodo"),a(),n(61,"select",76),f("ngModelChange",function(t){m(e);let r=l();return C(r.formEdit.periodo,t)||(r.formEdit.periodo=t),p(t)}),n(62,"option",72),d(63,"Seleccione"),a(),n(64,"option",77),d(65,"1 Q "),a(),n(66,"option",78),d(67,"2 Q"),a(),n(68,"option",79),d(69,"3 Q"),a(),n(70,"option",80),d(71,"4 Q"),a()()()()(),n(72,"div",9)(73,"label",10),d(74,"Concepto"),a(),n(75,"div",33)(76,"textarea",81),f("ngModelChange",function(t){m(e);let r=l();return C(r.formEdit.concepto,t)||(r.formEdit.concepto=t),p(t)}),a()()(),n(77,"div",82)(78,"button",83),u("click",function(){m(e);let t=l();return p(t.Actualizar_actividad())}),d(79," Editar Actividad "),a()()()()()(),n(80,"div",84)(81,"button",85),u("click",function(){m(e);let t=l();return p(t.cerrarModalEditAct())}),d(82," Cerrar "),a()()()()()()}if(c&2){let e=l();s(14),g("ngModel",e.formEdit.fechaActividad),_("max",e.maxDate),s(6),g("ngModel",e.formEdit.tipo),s(3),_("ngForOf",e.tipos),s(2),_("value","marca"),g("ngModel",e.modoCheck),s(4),_("value","proveedor"),g("ngModel",e.modoCheck),s(10),g("ngModel",e.formEdit.marca),s(3),_("ngForOf",e.marcas),s(7),g("ngModel",e.formEdit.valor),s(8),g("ngModel",e.formEdit.referencia),s(4),g("ngModel",e.formEdit.periodo),s(15),g("ngModel",e.formEdit.concepto)}}function Ne(c,i){if(c&1){let e=x();n(0,"div",98)(1,"div",99),I(2,"hr"),n(3,"div",100)(4,"div",29),d(5,"PROVEEDOR"),a(),n(6,"div",30),d(7),a()(),n(8,"div",28)(9,"div",29),d(10,"DETALLE"),a(),n(11,"div",30),d(12),a()(),n(13,"div",28)(14,"div",29),d(15,"VALOR"),a(),n(16,"div",30),d(17),le(18,"number"),a()(),n(19,"div",101)(20,"div",102),d(21,"SALDO"),a(),n(22,"div",103),d(23),le(24,"number"),a()(),n(25,"div",104)(26,"input",105),f("ngModelChange",function(t){let r=m(e).$implicit;return C(r.valorAplicar,t)||(r.valorAplicar=t),p(t)}),a(),n(27,"button",106),u("click",function(){let t=m(e).$implicit,r=l(2);return p(r.Aplicar_Documento(t))}),d(28," Aplicar "),a()()()()}if(c&2){let e=i.$implicit;s(7),w(e==null?null:e.PROVEEDOR),s(5),w(e==null?null:e.ACR_DETALLE),s(5),h("$",ce(18,5,e==null?null:e.ACR_VALOR_DOCUMENTO,"1.2-2"),""),s(6),h(" $",ce(24,8,e==null?null:e.SALDO,"1.2-2")," "),s(3),g("ngModel",e.valorAplicar)}}function ke(c,i){if(c&1){let e=x();n(0,"div")(1,"div",53),u("click",function(){m(e);let t=l();return p(t.cerrarModalAsignGastoAct())}),a(),n(2,"div",54)(3,"div",87)(4,"div",56)(5,"div",57)(6,"h5",58),d(7,"Asignar Gastos"),a(),n(8,"button",59),u("click",function(){m(e);let t=l();return p(t.cerrarModalAsignGastoAct())}),a()(),n(9,"div",60)(10,"div",61)(11,"div",88)(12,"div",6)(13,"h5",9),d(14),a(),n(15,"h6",89),d(16),a(),n(17,"div",1)(18,"div",90)(19,"div",9)(20,"label",27),d(21,"Fecha de Creaci\xF3n:"),a(),n(22,"div",91),d(23),a()(),n(24,"div",9)(25,"label",27),d(26,"Referencia:"),a(),n(27,"div",91),d(28),a()(),n(29,"div",9)(30,"label",27),d(31,"Valor:"),a(),n(32,"div",91),d(33),a()(),n(34,"div",9)(35,"label",27),d(36,"Concepto:"),a(),n(37,"div",91),d(38),a()()(),n(39,"div",52)(40,"div",9)(41,"label",27),d(42,"Marca / Proveedor:"),a(),n(43,"div",91),d(44),a()(),n(45,"div",9)(46,"label",27),d(47,"Tipo:"),a(),n(48,"div",91),d(49),a()(),n(50,"div",9)(51,"label",27),d(52,"Periodo:"),a(),n(53,"div",91),d(54),a()()(),n(55,"div",92)(56,"h1",32),d(57,"Asignar Gasto "),a(),n(58,"div",9)(59,"label",10),d(60,"Tipo de Documento"),a(),n(61,"select",93),f("ngModelChange",function(t){m(e);let r=l();return C(r.formAsignGasto.tipoDocumento,t)||(r.formAsignGasto.tipoDocumento=t),p(t)}),n(62,"option",72),d(63,"Seleccione"),a(),n(64,"option",94),d(65,"PRV-FA"),a()()(),n(66,"div",9)(67,"label",10),d(68,"Detalle"),a(),n(69,"div",33)(70,"span",73),I(71,"i",95),a(),n(72,"input",96),f("ngModelChange",function(t){m(e);let r=l();return C(r.formAsignGasto.detalle_documento,t)||(r.formAsignGasto.detalle_documento=t),p(t)}),a()()(),n(73,"button",38),u("click",function(){m(e);let t=l();return p(t.Buscar_Documentos())}),d(74," Buscar Documentos "),a()()(),y(75,Ne,29,11,"div",97),a()()()(),n(76,"div",84)(77,"button",85),u("click",function(){m(e);let t=l();return p(t.cerrarModalAsignGastoAct())}),d(78," Cerrar "),a()()()()()()}if(c&2){let e=l();s(14),h(" Actividad #",e.actividadSeleccionada==null?null:e.actividadSeleccionada.ACTIVIDAD_ID," "),s(2),h(" Consolidado #",(e.actividadSeleccionada==null?null:e.actividadSeleccionada.consolidado_id)||"N/A"," "),s(7),h(" ",e.actividadSeleccionada==null?null:e.actividadSeleccionada.ACTIVIDAD_FECHA_CREADA," "),s(5),h(" ",e.actividadSeleccionada==null?null:e.actividadSeleccionada.ACTIVIDAD_REFERENCIA," "),s(5),h(" $ ",e.actividadSeleccionada==null?null:e.actividadSeleccionada.ACTIVIDAD_PRESUPUESTO," "),s(5),h(" ",e.actividadSeleccionada==null?null:e.actividadSeleccionada.ACTIVIDAD_CONCEPTO," "),s(6),h(" ",e.actividadSeleccionada==null?null:e.actividadSeleccionada.ACTIVIDAD_MARCA_NOMBRE," "),s(5),h(" ",e.actividadSeleccionada==null?null:e.actividadSeleccionada.ACTIVIDAD_TIPO," "),s(5),h(" ",e.actividadSeleccionada==null?null:e.actividadSeleccionada.ACTIVIDAD_PERIODO," Q "),s(7),g("ngModel",e.formAsignGasto.tipoDocumento),s(11),g("ngModel",e.formAsignGasto.detalle_documento),s(3),_("ngForOf",e.asignGastosDocs)}}function Re(c,i){if(c&1){let e=x();n(0,"div")(1,"div",53),u("click",function(){m(e);let t=l();return p(t.cerrarModalAddConsolidado())}),a(),n(2,"div",54)(3,"div",107)(4,"div",56)(5,"div",57)(6,"h5",58),d(7,"Consolidado"),a(),n(8,"button",59),u("click",function(){m(e);let t=l();return p(t.cerrarModalAddConsolidado())}),a()(),n(9,"div",60)(10,"div",61)(11,"div",9)(12,"label",10),d(13,"Referencia"),a(),n(14,"div",33)(15,"span",73),d(16,"#"),a(),n(17,"input",75),f("ngModelChange",function(t){m(e);let r=l();return C(r.formAddCons.referencia,t)||(r.formAddCons.referencia=t),p(t)}),a()()(),n(18,"div",9)(19,"label",10),d(20,"Descripcion"),a(),n(21,"div",33)(22,"textarea",108),f("ngModelChange",function(t){m(e);let r=l();return C(r.formAddCons.descripcion,t)||(r.formAddCons.descripcion=t),p(t)}),a()()(),n(23,"div",82)(24,"button",109),u("click",function(){m(e);let t=l();return p(t.crearConsolidado(t.consolidadoSeleccionada))}),d(25),a()(),n(26,"div",22)(27,"app-table",110),u("action",function(t){m(e);let r=l();return p(r.onActAction(t))})("selectedRowsChange",function(t){m(e);let r=l();return p(r.onRowsSelected(t))}),a()()()(),n(28,"div",84)(29,"button",85),u("click",function(){m(e);let t=l();return p(t.cerrarModalAddConsolidado())}),d(30," Cerrar "),a()()()()()()}if(c&2){let e=l();s(17),g("ngModel",e.formAddCons.referencia),s(5),g("ngModel",e.formAddCons.descripcion),s(3),h(" ",e.nuevoConsolidado===1?"Crear Consolidado":"Actualizar Consolidado"," "),s(2),_("tableConfig",e.ActividadesxConsolidarTableConfig)("pageSize",10)("paginateDetails",!0)("selectedRows",!0)}}function Fe(c,i){if(c&1){let e=x();n(0,"div")(1,"div",53),u("click",function(){m(e);let t=l();return p(t.cerrarModalVerActConsolidado())}),a(),n(2,"div",54)(3,"div",107)(4,"div",56)(5,"div",57)(6,"h5",58),d(7,"Consolidado"),a(),n(8,"button",59),u("click",function(){m(e);let t=l();return p(t.cerrarModalVerActConsolidado())}),a()(),n(9,"div",60)(10,"div",61)(11,"div",22)(12,"app-table",111),u("action",function(t){m(e);let r=l();return p(r.onActAction(t))}),a()()()(),n(13,"div",84)(14,"button",85),u("click",function(){m(e);let t=l();return p(t.cerrarModalVerActConsolidado())}),d(15," Cerrar "),a()()()()()()}if(c&2){let e=l();s(12),_("tableConfig",e.ConsolidadosActTableConfig)("pageSize",10)("paginateDetails",!0)("selectedRows",!1)}}var de=class c{constructor(i,e,o,t){this.service=i;this.serviceEdit=e;this.cdr=o;this.router=t}sessionData=null;maxDate="";marca=null;tipos=[];marcas=[];actividadSeleccionada=null;consolidadoSeleccionada=null;showModalEdit=!1;showModalAsignGasto=!1;showModalAddConsolidado=!1;showPayConsolidado=!1;showModalVerActConsolidado=!1;showPayNotaCredito=!1;showPayIngreso=!1;seleccionados=[];nuevoConsolidado=1;asignGastosDocs=null;documentoPago=0;ARRAY_PAGOS_SELECCIONADOS=[];SUMA_PAGOS_SELECCIONADOS=0;activeTab="actividades";form={FECHAINI:"",FECHAFIN:""};modoCheck="marca";formEdit={tipo:"",marca:{},referencia:"",fecha:"",periodo:"",concepto:"",valor:0,fechaActividad:"",check_marca:this.modoCheck==="marca"?0:1};formAddCons={referencia:"",descripcion:""};formAsignGasto={tipoDocumento:"",detalle_documento:""};formAsignPago={pay:"",empresa:"",valor:0,documentoTipo:"",documento:"",detalledt:"",valordt:0,saldodt:0};Buttons_Export=["excel"];consolidadosButtons=[{label:"",action:"create",icon:"fa fa-plus",class:"btn btn-success",tooltip:"Guardar"},{label:"",action:"pay",icon:"fa fa-hand-holding-dollar",class:"btn btn-primary",tooltip:"Asignar Pago"}];ActividadesTableConfig={columns:[{title:"Actividad",field_value:"actividad_template",sort:!1},{title:"Marca",field_value:"ACTIVIDAD_MARCA_NOMBRE",sort:!0},{title:"Tipo",field_value:"ACTIVIDAD_TIPO",sort:!0},{title:"Concepto",field_value:"ACTIVIDAD_CONCEPTO",sort:!0},{title:"Presupuesto",field_value:"ACTIVIDAD_PRESUPUESTO",sort:!0},{title:"Consolidado",field_value:"CONSOLIDADO_TEMPLATE",sort:!0}],row_action:[{label:"",action_to_perform:"edit",icon:"fa fa-edit",type:"button",class:"btn btn-primary btn-sm",tooltip:"Editar"},{label:"",action_to_perform:"asignarPago",icon:"fa fa-money-bill",type:"button",class:"btn btn-success btn-sm",tooltip:"Asignar Gasto"},{label:"",action_to_perform:"delete",icon:"fa fa-trash",type:"button",class:"btn btn-danger btn-sm",tooltip:"Borrar"}],data:[]};ActividadesxConsolidarTableConfig={columns:[{title:"Actividad",field_value:"actividad_template",sort:!1},{title:"Marca",field_value:"ACTIVIDAD_MARCA_NOMBRE",sort:!0},{title:"Tipo",field_value:"ACTIVIDAD_TIPO",sort:!0},{title:"Concepto",field_value:"ACTIVIDAD_CONCEPTO",sort:!0},{title:"Presupuesto",field_value:"ACTIVIDAD_PRESUPUESTO",sort:!0}],data:[]};ConsolidadosTableConfig={columns:[{title:"Consolidado",field_value:"consolidado_template",sort:!0},{title:"Concepto",field_value:"CONSOLIDADO_DESCRIPCION",sort:!0},{title:"Actividades",field_value:"ACTIVIDADES_CANTIDAD",sort:!0},{title:"Presupuesto",field_value:"ACTIVIDAD_PRESUPUESTO",sort:!0},{title:"Gastos",field_value:"_SUMA_GASTOS",sort:!0},{title:"Saldo",field_value:"_SALDO",sort:!0},{title:"Pago",field_value:"_SUMA_PAGOS",sort:!0}],row_action:[{label:"",action_to_perform:"edit",icon:"fa fa-edit",type:"button",class:"btn btn-primary btn-sm",tooltip:"Editar"},{label:"",action_to_perform:"ver",icon:"fa fa-eye",type:"button",class:"btn btn-info btn-sm",tooltip:"Ver Actividades"}],data:[]};ConsolidadosActTableConfig={columns:[{title:"Actividad",field_value:"actividad_template",sort:!1},{title:"Marca",field_value:"ACTIVIDAD_MARCA_NOMBRE",sort:!0},{title:"Tipo",field_value:"ACTIVIDAD_TIPO",sort:!0},{title:"Concepto",field_value:"ACTIVIDAD_CONCEPTO",sort:!0},{title:"Presupuesto",field_value:"ACTIVIDAD_PRESUPUESTO",sort:!0},{title:"Consolidado",field_value:"CONSOLIDADO_TEMPLATE",sort:!0}],data:[]};ngOnInit(){this.maxDate=new Date().toISOString().split("T")[0],this.form.FECHAFIN=this.maxDate}convertirFecha(i){return i?i.replace(/-/g,""):""}Cargar_Datos_Actividades(){let i={FECHAINI:this.convertirFecha(this.form.FECHAINI),FECHAFIN:this.convertirFecha(this.form.FECHAFIN)};this.service.marca_creada(i).subscribe({next:e=>{e.success&&(this.ConsolidadosTableConfig=E(A({},this.ConsolidadosTableConfig),{data:e.consolidadas.map(o=>E(A({},o),{consolidado_template:`
      <div>
        <div><strong>Consolidado:</strong> #${o.CONSOLIDADO_ID}</div>
        <strong>Fecha Creaci\xF3n:</strong> ${o.CONSOLIDADO_CREADO_FECHA}
        <strong>Creado Por:</strong> ${o.CONSOLIDADO_CREADO_POR}
        <strong>Referencia:</strong> ${o.CONSOLIDADO_REFERENCIA}
      </div>
    `}))}),this.ActividadesTableConfig=E(A({},this.ActividadesTableConfig),{data:e.individuales.map(o=>E(A({},o),{CONSOLIDADO_TEMPLATE:o.consolidado_id?`<div>#${o.consolidado_id}</div>`:" - ",actividad_template:`
      <div>
        <div><strong>Actividad:</strong> #${o.ACTIVIDAD_ID}</div>
        <strong>Fecha creaci\xF3n:</strong> ${o.ACTIVIDAD_FECHA_CREADA}
        <strong>Referencia:</strong> ${o.ACTIVIDAD_REFERENCIA}
      </div>
    `}))}),this.ActividadesxConsolidarTableConfig=E(A({},this.ActividadesxConsolidarTableConfig),{data:e.individuales.filter(o=>o.consolidado==0).map(o=>E(A({},o),{actividad_template:`
      <div>
        <div><strong>Actividad:</strong> #${o.ACTIVIDAD_ID}</div>
        <strong>Fecha creaci\xF3n:</strong> ${o.ACTIVIDAD_FECHA_CREADA}
        <strong>Referencia:</strong> ${o.ACTIVIDAD_REFERENCIA}
      </div>
    `}))}))}})}onActAction(i){switch(this.actividadSeleccionada=i.data,i.action_to_perform){case"edit":this.abrirModalEditAct(),this.Cargar_Tipos_Marcas(),this.Cargar_Marcas(),setTimeout(()=>{this.cargarDatosEnFormulario(i.data)},150),console.log("Edit");break;case"asignarPago":this.abrirModalAsignGastoAct(),console.log(this.actividadSeleccionada),console.log("asignarPago");break;case"delete":this.actividadSeleccionada.consolidado==0?this.Eliminar_linea(this.actividadSeleccionada.ACTIVIDAD_ID):v.default.fire("Error","Actividad No se puede Eliminar porque esta Consignada","error"),console.log("delete");break;default:break}}onListAction(i){switch(this.consolidadoSeleccionada=i.data,i.action_to_perform){case"edit":this.nuevoConsolidado=0,this.Limpiar_campos(),this.limpiarSeleccionActividadesXConsolidar(),this.llenarFormConsolidado(i.data),this.abrirModalAddConsolidado(),console.log(this.consolidadoSeleccionada),console.log("Edit");break;case"ver":this.llenarVerConsolidado(i.data),this.abrirModalVerActConsolidado(),console.log(this.consolidadoSeleccionada),console.log("Ver");break;default:break}}onListConsAction(i){switch(i.action){case"create":this.nuevoConsolidado=1,this.Limpiar_campos(),this.limpiarSeleccionActividadesXConsolidar(),this.abrirModalAddConsolidado(),console.log("Create");break;case"pay":this.Limpiar_campos(),this.limpiarSeleccionConsolidar(),this.tooglePayConsolidado(),console.log("Pay");break;default:break}}onRowsSelected(i){console.log(i),this.seleccionados=i,this.recalcularSuma(i)}recalcularSuma(i){let e=0;i.forEach(o=>{let t=o?._SALDO??o?.ACTIVIDAD_PRESUPUESTO??0,r=parseFloat((t??0).toString());isNaN(r)||(e+=r)}),this.SUMA_PAGOS_SELECCIONADOS=e,this.formAsignPago.valor=e}abrirModalEditAct(){this.showModalEdit=!0}cerrarModalEditAct(){this.showModalEdit=!1,this.Limpiar_campos()}abrirModalAsignGastoAct(){this.showModalAsignGasto=!0}cerrarModalAsignGastoAct(){this.showModalAsignGasto=!1,this.Limpiar_campos()}abrirModalAddConsolidado(){this.showModalAddConsolidado=!0}cerrarModalAddConsolidado(){this.showModalAddConsolidado=!1,this.limpiarSeleccionActividadesXConsolidar(),this.Limpiar_campos()}abrirModalVerActConsolidado(){this.showModalVerActConsolidado=!0}cerrarModalVerActConsolidado(){this.showModalVerActConsolidado=!1,this.Limpiar_campos()}tooglePayConsolidado(){this.showPayConsolidado=!this.showPayConsolidado,this.showPayIngreso=!1,this.showPayNotaCredito=!1,this.Limpiar_campos(),this.limpiarSeleccionConsolidar()}tooglePayNotaCredito(){this.showPayNotaCredito=!this.showPayNotaCredito,this.formAsignPago.pay=this.showPayNotaCredito?"NOTA_CREDITO":"",this.showPayNotaCredito&&(this.showPayIngreso=!1),this.Limpiar_campos(),this.limpiarSeleccionConsolidar()}tooglePayIngreso(){this.showPayIngreso=!this.showPayIngreso,this.showPayIngreso&&(this.formAsignPago.pay=this.showPayIngreso?"INGRESO":"",this.showPayNotaCredito=!1),this.Limpiar_campos(),this.limpiarSeleccionConsolidar()}llenarFormConsolidado(i){this.formAddCons={referencia:i.CONSOLIDADO_REFERENCIA||"",descripcion:i.CONSOLIDADO_DESCRIPCION||""},this.consolidadoSeleccionada=i;let e=i._detalle_actividades?[...i._detalle_actividades]:[],o=S=>E(A({},S),{actividad_template:`
        <div>
          <div><strong>Actividad:</strong> #${S.ACTIVIDAD_ID}</div>
          <strong>Fecha creaci\xF3n:</strong> ${S.ACTIVIDAD_FECHA}
          <strong>Referencia:</strong> ${S.ACTIVIDAD_REFERENCIA}
        </div>
      `,ACTIVIDAD_PRESUPUESTO:S.ACTIVIDAD_VALOR,is_checked:!0}),t=e.map(o),b=(this.ActividadesxConsolidarTableConfig?.data||[]).filter(S=>!e.some(k=>k.ACTIVIDAD_ID===S.ACTIVIDAD_ID)).map(S=>E(A({},S),{is_checked:!1})),M=[...t,...b];this.ActividadesxConsolidarTableConfig=E(A({},this.ActividadesxConsolidarTableConfig),{data:M}),this.seleccionados=t.map(S=>S)}llenarVerConsolidado(i){let e=i._detalle_actividades?[...i._detalle_actividades]:[];this.ConsolidadosActTableConfig=E(A({},this.ConsolidadosActTableConfig),{data:e.map(o=>E(A({},o),{CONSOLIDADO_TEMPLATE:o.consolidado_id?`<div>#${o.consolidado_id}</div>`:" - ",actividad_template:`
      <div>
        <div><strong>Actividad:</strong> #${o.ACTIVIDAD_ID}</div>
        <div><strong>Fecha creaci\xF3n:</strong> ${o.ACTIVIDAD_FECHA}</div>
        <div><strong>Referencia:</strong> ${o.ACTIVIDAD_REFERENCIA}</div>
      </div>
    `}))})}limpiarFormConsolidado(){}limpiarSeleccionActividadesXConsolidar(){try{let e=(this.ActividadesxConsolidarTableConfig?.data||[]).map(o=>{let t=A({},o);return t.hasOwnProperty("is_checked")&&(t.is_checked=!1),t});this.ActividadesxConsolidarTableConfig=E(A({},this.ActividadesxConsolidarTableConfig),{data:e}),this.seleccionados=[],this.cdr.detectChanges()}catch(i){console.error("Error limpiando selecci\xF3n ActividadesxConsolidar",i)}}limpiarSeleccionConsolidar(){try{let e=(this.ConsolidadosTableConfig?.data||[]).map(o=>{let t=A({},o);return t.hasOwnProperty("is_checked")&&(t.is_checked=!1),t});this.ConsolidadosTableConfig=E(A({},this.ConsolidadosTableConfig),{data:e}),this.seleccionados=[],this.cdr.detectChanges()}catch(i){console.error("Error limpiando selecci\xF3n Consolidar",i)}}crearConsolidado(i){let e=this.formAddCons.referencia,o=this.formAddCons.descripcion,t=i?.CONSOLIDADO_ID??"",r=this.nuevoConsolidado,M={DATOS:[...this.seleccionados],CONSOLIDADO_ID:t,CONSOLIDADO_NUEVO:r,REFERENCIA:e,DESCRIPCION:o};this.service.Consolidar_Actividades(M).subscribe({next:S=>{if(!S.success){v.default.fire("Error","No se pudo Crear Consolidado","error");return}v.default.fire("\xC9xito","Consolidado guardada correctamente","success"),this.cerrarModalAddConsolidado(),this.Cargar_Datos_Actividades()}})}Validar_Pago(){let i=this.formAsignPago.documento,e=this.formAsignPago.pay,o=this.formAsignPago.empresa,t=this.formAsignPago.documentoTipo,r={PG_NUMERO_DOCUMENTO:i,DOCUMENTO:e,empresa:o,tipoDocumentoValor:t};if(console.log(r),i==""){v.default.fire("Debe ingresar un numero de documento","","error");return}v.default.fire({title:"Validando documento",html:"Espere por favor...",allowOutsideClick:!1,didOpen:()=>{v.default.showLoading(),this.service.Validar_Pagos(r).subscribe({next:b=>{if(v.default.close(),console.log(b),!b.success){v.default.fire("Error","No se pudo Validar Documento","error");return}b.data&&b.data.length>0?(this.ARRAY_PAGOS_SELECCIONADOS=b.data,this.formAsignPago.detalledt=b.data[0].DOC_DETALLE,this.formAsignPago.valordt=b.data[0].DOC_VALOR,this.formAsignPago.saldodt=b.data[0].SALDO,console.log("Log ARRAY_PAGOS_SELECCIONADOS ",this.ARRAY_PAGOS_SELECCIONADOS),console.log("Log FormAsignPago ",this.formAsignPago),v.default.fire("\xC9xito","Pago validado correctamente","success")):v.default.fire("No existe un Pago con ese numero de documento","","error")},error:b=>{v.default.close(),console.error("Validar_Pagos error",b),v.default.fire("Error","Ocurri\xF3 un error al validar el documento","error")}})}})}Agregar_Pago(){let i=this.SUMA_PAGOS_SELECCIONADOS||0,e={Valor_Aplicar:this.SUMA_PAGOS_SELECCIONADOS,ARRAY_PAGOS_SELECCIONADOS:this.ARRAY_PAGOS_SELECCIONADOS,CONSOLIDADOS_SELECCIONADOS:this.seleccionados};if(console.log("param: ",e),this.seleccionados.length==0){v.default.fire("Debe seleccionar al menos un consolidado","","error");return}if(this.ARRAY_PAGOS_SELECCIONADOS.length==0){v.default.fire("Debe buscar un pago antes de agregarlo","","error");return}if(i<=0){v.default.fire("No se han ingresado valores a aplicar","","error");return}if(this.ARRAY_PAGOS_SELECCIONADOS[0].SALDO<i){v.default.fire("El valor a aplicar es mayor que el saldo disponible","","error");return}v.default.fire({title:"Se agregar\xE1 el pago?",text:"No podr\xE1s revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xED, agregarlo!"}).then(o=>{o.isConfirmed&&this.service.Agregar_Pago(e).subscribe({next:t=>{t.success||v.default.fire("Error","No se pudo Agregar el Pago","error"),v.default.fire("\xC9xito","Pago agregado Correctamente","success")}})})}cargarDatosEnFormulario(i){let e=i.ACTIVIDAD_FECHA?.split(" ")[0]||"",o=i.ACTIVIDAD_FECHA_CREADA?.split(" ")[0]||"";this.formEdit={tipo:i.ACTIVIDAD_TIPO_ID||"",marca:this.marcas.find(t=>t.Nombre===i.ACTIVIDAD_MARCA_NOMBRE)||null,referencia:i.ACTIVIDAD_REFERENCIA||"",fecha:o||"",periodo:i.ACTIVIDAD_PERIODO||"",concepto:i.ACTIVIDAD_CONCEPTO||"",valor:i.ACTIVIDAD_PRESUPUESTO||0,fechaActividad:e||"",check_marca:i.CHECK_MARCA??0},this.modoCheck=this.formEdit.check_marca===0?"marca":"proveedor"}onCheckMarcaChange(){this.Cargar_Marcas()}mostrarAlerta(i){v.default.fire({icon:"error",title:"Error de validaci\xF3n",text:`El campo "${i}" es obligatorio.`,confirmButtonText:"Aceptar"})}Actualizar_actividad(){let i=o=>o==null||typeof o=="string"&&o.trim()==="";if(i(this.formEdit.fechaActividad)){this.mostrarAlerta("Fecha de Actividad");return}if(i(this.formEdit.tipo)){this.mostrarAlerta("Tipo");return}if(i(this.formEdit.marca?.ID)){let o=this.modoCheck==="marca"?"Marca":"Proveedor";this.mostrarAlerta(o);return}if(i(this.formEdit.referencia)){this.mostrarAlerta("Referencia");return}if(i(this.formEdit.periodo)){this.mostrarAlerta("Periodo");return}if(this.formEdit.valor===null||this.formEdit.valor<=0){this.mostrarAlerta("Valor");return}if(i(this.formEdit.concepto)){this.mostrarAlerta("Concepto");return}let e={Tipo:this.formEdit.tipo,MarcaID:this.formEdit.marca?.ID,MarcaNombre:this.formEdit.marca?.Nombre,Referencia:this.formEdit.referencia,Periodo:this.formEdit.periodo,Concepto:this.formEdit.concepto,valor:this.formEdit.valor,Fecha_actividad:this.formEdit.fechaActividad,Cheek_marca:this.formEdit.check_marca,Actividad_ID:this.actividadSeleccionada.ACTIVIDAD_ID};this.service.Actualizar_actividad(e).subscribe({next:o=>{if(!o.success){v.default.fire("Error","No se pudo Editar la actividad","error");return}v.default.fire("\xC9xito","Actividad guardada correctamente","success"),this.cerrarModalEditAct(),this.Cargar_Datos_Actividades()}})}Eliminar_linea(i){let e={ID_Marca:i};this.service.Eliminar_actividad_creada(e).subscribe({next:o=>{if(!o.success){v.default.fire("Error","No se pudo Eliminar la actividad","error");return}v.default.fire("\xC9xito","Actividad Eliminada correctamente","success"),this.Cargar_Datos_Actividades()}})}Limpiar_campos(){this.consolidadoSeleccionada=null,this.seleccionados=[],this.formEdit={tipo:"",marca:null,referencia:"",fecha:"",periodo:"",concepto:"",valor:0,fechaActividad:"",check_marca:this.modoCheck==="marca"?0:1},this.formAddCons={referencia:"",descripcion:""},this.formAsignGasto={tipoDocumento:"",detalle_documento:""},this.formAsignPago={pay:"",empresa:"",valor:0,documentoTipo:"",documento:"",detalledt:"",valordt:0,saldodt:0},this.asignGastosDocs="",this.documentoPago=0,this.ARRAY_PAGOS_SELECCIONADOS=[],this.SUMA_PAGOS_SELECCIONADOS=0,this.formAsignPago.valor=0,this.cdr.detectChanges()}Cargar_Tipos_Marcas(){this.service.Cargar_Tipos_Marcas().subscribe({next:i=>{i.success&&(this.tipos=i.data)}})}Cargar_Marcas(){let i={marca:this.modoCheck==="marca"?0:1};this.serviceEdit.Cargar_Marcas(i).subscribe({next:e=>{e.success&&(this.marcas=e.data)}})}Buscar_Documentos(){if(!this.formAsignGasto.tipoDocumento){v.default.fire("Error","Seleccione un tipo de documento","warning");return}if(!this.formAsignGasto.detalle_documento){v.default.fire("Error","Ingrese el detalle del documento","warning");return}let i={Tipo_Documento:this.formAsignGasto.tipoDocumento,Dt_Documento:this.formAsignGasto.detalle_documento};this.service.Buscar_Documentos(i).subscribe({next:e=>{if(console.log(e),!e.success){v.default.fire("Sin resultados","No se encontraron documentos que coincidan","info");return}this.asignGastosDocs=Array.isArray(e.data)?e.data:[e.data],this.asignGastosDocs.forEach(o=>o.valorAplicar=0),console.log("AsignGastosDocs",this.asignGastosDocs),v.default.fire("\xC9xito","Se encontr\xF3 documento","success")}})}Aplicar_Documento(i){let e=Number(i?.valorAplicar)||0,o=this.actividadSeleccionada?.ACTIVIDAD_ID,t=this.formAsignGasto.tipoDocumento,r=i,b=[i];if(i?.SALDO<e){v.default.fire("Error","El valor a aplicar no puede ser mayor al saldo del documento");return}if(e<=0){v.default.fire("Error","El valor a aplicar no puede ser 0");return}let M={Valor_Aplicar:e,Consolidado_id:o,ARRAY_DOCUMENTOS_SELECCIONADOS:b,Tipo_Documento:t,Id_Documento:r};console.log("Aplicar_Documento param",M),v.default.fire({title:"Se agregar\xE1 el gasto?",text:"No podr\xE1s revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xED, agregarlo!"}).then(S=>{S.isConfirmed&&this.service.GUARDAR_DATOS(M).subscribe({next:k=>{if(console.log(k),!k.success){v.default.fire("Error","No se pudo guardar el gasto","error");return}k.success&&v.default.fire("Exito","Gasto Agregado Correctamente","success"),this.Cargar_Datos_Actividades()}})})}static \u0275fac=function(e){return new(e||c)(D(re),D(N),D(B),D(q))};static \u0275cmp=T({type:c,selectors:[["app-listact"]],decls:36,vars:14,consts:[[1,"container-fluid","customer-order-wrapper"],[1,"row"],[1,"col-12"],[3,"headerTitle","cardClass"],[1,"col-md-7"],[1,"card","shadow-bg","border-0"],[1,"card-body"],[1,"row","align-items-end"],[1,"col-md-4"],[1,"mb-3"],[1,"form-label"],["type","date","id","fechaInicio","required","",1,"form-control",3,"ngModelChange","ngModel","max"],["type","date","id","fechaFin","required","",1,"form-control",3,"ngModelChange","ngModel","max"],[1,"mb-3","d-grid"],[1,"btn","btn-primary",3,"click"],[1,"d-flex","gap-3"],[1,"btn","btn-success","w-100",3,"click","ngClass"],[4,"ngIf"],["id","SECC_INVIDIDUALES",1,"mt-3"],[1,"text-gray-100"],[1,"table-responsive"],["id","text_cant_inv"],[1,"customer-order-report","table-responsive","custom-scrollbar"],[3,"action","tableConfig","pageSize","paginateDetails","selectedRows","downloadReports","exportButtons"],[3,"action","customAction","selectedRowsChange","tableConfig","pageSize","paginateDetails","selectedRows","customButtons"],[1,"col-md-5"],[1,"btn","w-100",3,"click","ngClass"],[1,"form-label","fw-bold"],[1,"d-flex","justify-content-between","mt-2"],[1,"text-muted"],[1,"fw-semibold","text-end"],[1,"bg-primary","p-3","rounded","col-md-5","border-start"],[1,"text-white","mb-3"],[1,"input-group"],["type","text","min","0","placeholder","Documento",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-append"],[1,"btn","btn-info","w-100",3,"click"],["type","number","min","0","placeholder","$0.00",1,"form-control",3,"ngModelChange","ngModel","disabled"],[1,"btn","btn-success","w-100",3,"click"],[1,"col-md-2"],[1,"form-check"],["type","radio","name","empresaPago","id","emp_cartimex",1,"form-check-input",3,"ngModelChange","ngModel","value"],["for","emp_cartimex",1,"form-check-label"],["type","radio","name","empresaPago","id","emp_computron",1,"form-check-input",3,"ngModelChange","ngModel","value"],["for","emp_computron",1,"form-check-label"],[1,"col-md-2","border-start"],["type","radio","name","docuementoTipo","id","BAN-DP",1,"form-check-input",3,"ngModelChange","ngModel","value"],["for","BAN-DP",1,"form-check-label"],["type","radio","name","docuementoTipo","id","BAN-ND",1,"form-check-input",3,"ngModelChange","ngModel","value"],["for","BAN-ND",1,"form-check-label"],["type","radio","name","docuementoTipo","id","BAN-IN",1,"form-check-input",3,"ngModelChange","ngModel","value"],["for","BAN-IN",1,"form-check-label"],[1,"col-md-3","border-start"],[1,"modal-backdrop","fade","show",3,"click"],["tabindex","-1",1,"modal","fade","show","d-block"],[1,"modal-dialog","modal-md","modal-dialog-scrollable"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"col-md-12"],["type","date","id","Fecha_actividad","required","",1,"form-control",3,"ngModelChange","ngModel","max"],[1,"text-danger"],["id","Tipo","required","",1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"ngValue",4,"ngFor","ngForOf"],["type","radio","id","check_Marca",1,"form-check-input",3,"ngModelChange","value","ngModel"],[1,"fst-italic"],["type","radio",1,"form-check-input",3,"ngModelChange","value","ngModel"],[1,"col-md-6"],["id","Marca","required","",1,"form-select",3,"ngModelChange","ngModel"],["value","","selected",""],[1,"input-group-text"],["type","number","id","Valor","placeholder","0.00","required","","min","0",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","xxxxxxxxxx","id","Referencia","required","",1,"form-control",3,"ngModelChange","ngModel"],["id","Periodo","required","",1,"form-select",3,"ngModelChange","ngModel"],["value","1"],["value","2"],["value","3"],["value","4"],["type","text","placeholder","Concepto","id","Concepto","required","","rows","3",1,"form-control",3,"ngModelChange","ngModel"],[1,"mt-3"],["id","Ingresar",1,"btn","btn-primary",3,"click"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[3,"ngValue"],[1,"modal-dialog","modal-xl","modal-dialog-scrollable"],[1,"card","shadow-sm","border-0"],[1,"mb-4"],[1,"col-md-3"],[1,"form-control-plaintext"],[1,"bg-primary","p-3","rounded","col-md-4","border-start"],["data-live-search","true","aria-label","Default","id","Tipo_PRE",1,"form-select",3,"ngModelChange","ngModel"],["value","PRV-FA"],[1,"fa-solid","fa-magnifying-glass"],["type","text","min","0",1,"form-control",3,"ngModelChange","ngModel"],["class","card border-info p-3",4,"ngFor","ngForOf"],[1,"card","border-info","p-3"],[1,"card-body","p-3"],[1,"d-flex","justify-content-between"],[1,"d-flex","justify-content-between","mt-2",2,"color","red"],[2,"color","red"],[1,"fw-semibold","text-end",2,"color","red"],[1,"mt-3","d-flex","gap-2","align-items-center"],["type","number","step","0.01",1,"form-control",2,"max-width","140px",3,"ngModelChange","ngModel"],[1,"btn","btn-info","text-white",3,"click"],[1,"modal-dialog","modal-lg","modal-dialog-scrollable"],["type","text","placeholder","Descripcion","id","Concepto","required","","rows","3",1,"form-control",3,"ngModelChange","ngModel"],["id","Ingresar",1,"btn","btn-success",3,"click"],[3,"action","selectedRowsChange","tableConfig","pageSize","paginateDetails","selectedRows"],[3,"action","tableConfig","pageSize","paginateDetails","selectedRows"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-card",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9)(10,"label",10),d(11,"Fecha Inicio"),a(),n(12,"input",11),f("ngModelChange",function(r){return C(o.form.FECHAINI,r)||(o.form.FECHAINI=r),r}),a()()(),n(13,"div",8)(14,"div",9)(15,"label",10),d(16,"Fecha Fin"),a(),n(17,"input",12),f("ngModelChange",function(r){return C(o.form.FECHAFIN,r)||(o.form.FECHAFIN=r),r}),a()()(),n(18,"div",8)(19,"div",13)(20,"button",14),u("click",function(){return o.Cargar_Datos_Actividades()}),d(21,"Cargar"),a()()()(),n(22,"div",8)(23,"div",15)(24,"div",9)(25,"button",16),u("click",function(){return o.activeTab="actividades"}),d(26,"Actividades"),a()(),n(27,"div",9)(28,"button",16),u("click",function(){return o.activeTab="consolidados"}),d(29,"Consolidados"),a()()()()()()(),y(30,we,9,6,"div",17)(31,Pe,10,6,"div",17)(32,Le,83,14,"div",17)(33,ke,79,12,"div",17)(34,Re,31,7,"div",17)(35,Fe,16,4,"div",17),a()()()()),e&2&&(s(3),_("headerTitle","Listado de Actividades")("cardClass","mb-4"),s(9),g("ngModel",o.form.FECHAINI),_("max",o.maxDate),s(5),g("ngModel",o.form.FECHAFIN),_("max",o.maxDate),s(8),_("ngClass",o.activeTab==="actividades"?"btn-success":"btn-light"),s(3),_("ngClass",o.activeTab==="consolidados"?"btn-success":"btn-light"),s(2),_("ngIf",o.activeTab==="actividades"),s(),_("ngIf",o.activeTab==="consolidados"),s(),_("ngIf",o.showModalEdit),s(),_("ngIf",o.showModalAsignGasto),s(),_("ngIf",o.showModalAddConsolidado),s(),_("ngIf",o.showModalVerActConsolidado))},dependencies:[O,G,P,ue,ge,V,K,Z,j,Q,J,X,z,ee,$,Y,L,fe],styles:[".custom-modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0000008c;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);z-index:998}.custom-modal[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(1);width:80%;max-height:95%;overflow-y:auto;background:#fff;border-radius:14px;z-index:999;padding:20px;animation:_ngcontent-%COMP%_modalFade .25s ease-out;box-shadow:0 0 35px #00000059}@keyframes _ngcontent-%COMP%_modalFade{0%{transform:translate(-50%,-50%) scale(.85);opacity:0}to{transform:translate(-50%,-50%) scale(1);opacity:1}}"]})};var me=c=>({"show active":c});function We(c,i){if(c&1){let e=x();n(0,"li",8)(1,"button",9),u("click",function(){let t=m(e).$implicit,r=l();return p(r.setTab(t.id))}),d(2),a()()}if(c&2){let e=i.$implicit,o=l();s(),_e("active",o.activeTab===e.id),s(),h(" ",e.label," ")}}var se=class c{tabs=[{id:"crear",label:"Nueva Actividad"},{id:"listar",label:"Procesar Actividades"},{id:"otra",label:"Que otra opci\xF3n"}];activeTab="crear";setTab(i){this.activeTab=i}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=T({type:c,selectors:[["app-proteccion-marcas"]],decls:14,vars:12,consts:[[1,"container-fluid","customer-order-wrapper"],[1,"row"],[1,"col-12"],[3,"headerTitle","cardClass"],[1,"nav","nav-tabs","mb-3"],["class","nav-item",4,"ngFor","ngForOf"],[1,"tab-content"],[1,"tab-pane","fade",3,"ngClass"],[1,"nav-item"],[1,"nav-link",3,"click"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-card",3)(4,"ul",4),y(5,We,3,3,"li",5),a(),n(6,"div",6)(7,"div",7),I(8,"app-crearact"),a(),n(9,"div",7),I(10,"app-listact"),a(),n(11,"div",7)(12,"p"),d(13,"Contenido de la otra pesta\xF1a..."),a()()()()()()()),e&2&&(s(3),_("headerTitle","Protecci\xF3n de Marcas")("cardClass","mb-4"),s(2),_("ngForOf",o.tabs),s(2),_("ngClass",W(6,me,o.activeTab==="crear")),s(2),_("ngClass",W(8,me,o.activeTab==="listar")),s(2),_("ngClass",W(10,me,o.activeTab==="otra")))},dependencies:[O,G,P,V,L,ae,de],encapsulation:2})};var mt=[{path:"proteccionMarcas",component:se,data:{title:"Protecci\xF3n de Marcas",breadcrumb:"Protecci\xF3n de Marcas"}}];export{mt as ImportComprasRoutes};
