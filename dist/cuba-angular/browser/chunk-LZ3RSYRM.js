import{a as Z}from"./chunk-INOCVZ2U.js";import{a as te}from"./chunk-POMG26IM.js";import{a as Y}from"./chunk-OXQZC7J3.js";import{a as V,b as ge}from"./chunk-EPETCGXL.js";import{B as Q,O as X,c as se,d as he,l as q,t as J,w as K}from"./chunk-YIZZPA6C.js";import{k as j,l as W,m as U,v as G}from"./chunk-ZRCY7LVU.js";import{Cb as m,Eb as D,Fc as L,Mb as s,Nb as d,Ob as N,Sb as T,Yb as w,Zb as u,a as E,b as P,ca as pe,db as c,e as ee,ha as fe,hc as f,ic as $,jb as I,jc as B,mc as z,nc as R,oc as H,pb as O,qa as g,ra as v,ub as y}from"./chunk-NIELWWGW.js";var b=ee(te());var k=class o extends ge{endpoint=V.apiUrl+"/oym/mpps/";constructor(e){super(e)}getUserSessionToken(){return localStorage.getItem("authToken")||localStorage.getItem("token")||""}getUserSessionData(){let e=localStorage.getItem("user")||"",t=null;try{e&&(t=JSON.parse(e))}catch{t=e}return t}headers=new se({"Content-Type":"application/json",Authorization:`Bearer ${this.getUserSessionToken()}`});CrearCarpetaMPPs(e){return e.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"CrearCarpetaMPPs",e,{headers:this.headers})}CargarCarpetaMPPs(e){return e.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"CargarCarpetaMPPs",e,{headers:this.headers})}EliminarCarpetaMPPs(e){return e.userdata=this.getUserSessionData(),this.http.post(this.endpoint+"EliminarCarpetaMPPs",e,{headers:this.headers})}GuardarArchivoMPPs(e,t,i){let r=new FormData,a=this.getUserSessionData();return r.append("userdata",JSON.stringify(a)),r.append("file",e),r.append("subpath",t),i&&r.append("metadata",JSON.stringify(i)),this.http.post(this.endpoint+"GuardarArchivoMPPs",r,{headers:new se({Authorization:`Bearer ${this.getUserSessionToken()}`})})}EditarArchivoMPPs(e,t,i){let r=this.getUserSessionData();return this.http.post(this.endpoint+"EditarArchivoMPPs",{path:e,newPath:t,metadata:i,userdata:r},{headers:this.headers})}EliminarArchivoMPPs(e){let t=this.getUserSessionData();return this.http.post(this.endpoint+"EliminarArchivoMPPs",{path:e,userdata:t},{headers:this.headers})}getDepartamentos(){return this.http.post(this.endpoint+"getDepartamentos",{},{headers:this.headers})}static \u0275fac=function(t){return new(t||o)(fe(he))};static \u0275prov=pe({token:o,factory:o.\u0275fac,providedIn:"root"})};function ve(o,e){if(o&1){let t=T();s(0,"div",13)(1,"div",5)(2,"div",14)(3,"input",15),H("ngModelChange",function(r){g(t);let a=u();return R(a.newFolderName,r)||(a.newFolderName=r),v(r)}),d(),s(4,"div",16)(5,"button",17),w("click",function(){g(t);let r=u();return v(r.createFolder())}),f(6,"Crear carpeta"),d()()()()()}if(o&2){let t=u();c(3),z("ngModel",t.newFolderName)}}function be(o,e){if(o&1){let t=T();s(0,"button",18),w("click",function(){g(t);let r=u();return v(r.goBackToDepartments())}),f(1,"\u2190 Volver a departamentos"),d()}}function _e(o,e){o&1&&(s(0,"div",22),f(1,"No hay carpetas."),d())}function Ce(o,e){if(o&1){let t=T();s(0,"li",25),w("click",function(){let r=g(t).$implicit,a=u(3);return v(a.selectFolder(r.path))}),s(1,"div",26),N(2,"i",27),f(3),d(),s(4,"div",28),f(5),d(),s(6,"div")(7,"button",29),w("click",function(r){let a=g(t).$implicit,n=u(3);return v(n.deleteFolder(r,a.path))}),N(8,"i",30),d()()()}if(o&2){let t=e.$implicit,i=u(3);D("active",i.selectedFolder===t.path),c(),m("title",t.name),c(2),B(" ",t.name," "),c(2),B("",(i.filesMap[t.path]==null?null:i.filesMap[t.path].length)||0," archivos")}}function xe(o,e){if(o&1&&(s(0,"ul",23),y(1,Ce,9,5,"li",24),d()),o&2){let t=u(2);c(),m("ngForOf",t.folders)}}function ye(o,e){if(o&1&&(s(0,"div",19)(1,"div",10)(2,"h6"),f(3,"Carpetas"),d(),y(4,_e,2,0,"div",20)(5,xe,2,1,"ul",21),d()()),o&2){let t=u();c(4),m("ngIf",t.folders.length===0),c(),m("ngIf",t.folders.length>0)}}function we(o,e){o&1&&(s(0,"h6"),f(1,"Archivos"),d())}function Fe(o,e){if(o&1&&(s(0,"h6"),f(1,"Archivos en: "),s(2,"small",31),f(3),d()()),o&2){let t=u();c(3),$(t.selectedFolderName)}}function Ee(o,e){o&1&&(s(0,"div",32),f(1,"Selecciona una carpeta a la izquierda para ver su contenido."),d())}function Pe(o,e){if(o&1){let t=T();s(0,"div")(1,"app-table",33),w("action",function(r){g(t);let a=u();return v(a.onFileTableAction(r))})("customAction",function(r){g(t);let a=u();return v(a.onCustomAction(r))}),d()()}if(o&2){let t=u();c(),m("hasCheckbox",!1)("tableConfig",t.filesTableConfig)("pageSize",10)("paginateDetails",!0)("selectedRows",!0)("downloadReports",!1)("customButtons",t.customButtons)}}var oe=class o{constructor(e,t,i){this.OymService=e;this.cdr=t;this.router=i}newFolderName="";folders=[];selectedFiles=[];selectedFolder=null;selectedFolderName=null;filesMap={};currentPath="manuales_de_funciones";pathStack=["manuales_de_funciones"];isAdmin=!1;get showFoldersPanel(){return this.isAdmin?(this.currentPath||"").split("/").filter(Boolean).length===1:!1}get canCreateFolder(){return this.isAdmin&&this.showFoldersPanel}customButtons=[{label:"",action:"add_file",icon:"fa fa-plus",class:"btn btn-success",tooltip:"Agregar nuevo archivo"}];filesTableConfig={columns:[{title:"Nombre",field_value:"nameHtml",sort:!0},{title:"Version",field_value:"version",sort:!0},{title:"Titulo",field_value:"title",sort:!0}],row_action:[{label:"",action_to_perform:"edit_file",icon:"edit",type:"button",class:"btn btn-light btn-sm",tooltip:"Editar"},{label:"",action_to_perform:"delete_file",icon:"trash",type:"button",class:"btn btn-danger btn-sm",tooltip:"Eliminar"}],data:[]};ngOnInit(){this.loadUserRole(),this.getDepartments(),this.loadPath(this.currentPath)}loadUserRole(){try{let e=localStorage.getItem("user");if(!e)return;let t=JSON.parse(e);this.isAdmin=t?.is_admin==="1"}catch{this.isAdmin=!1}}getDepartments(){this.OymService.getDepartamentos().subscribe({next:e=>{console.log("Departamentos:",e||[])},error:e=>{console.error(e)}})}loadPath(e){this.OymService.CargarCarpetaMPPs({subpath:e}).subscribe({next:t=>{if(!t||!t.success){this.folders=[],this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]}),this.selectedFolder=null,this.selectedFolderName=null;return}let i=t.currentPath||e||"manuales_de_funciones";this.currentPath=i;let r=(i||"").split("/").filter(Boolean),a=r.length===1;this.folders=(t.folders||[]).map(l=>({name:l.name,path:l.path||l.name}));let n=(t.files||[]).map(l=>{let M=(l.extension||"").toLowerCase(),A=this.getIconForExt(M),F=`${V.sgo_docs_base}/${l.path.split("/").map(encodeURIComponent).join("/")}`,S=`<i class="${A.cls} me-2"></i> <a href="${F}" download target="_blank" rel="noopener"> ${(l.name||"").replace(/</g,"&lt;").replace(/>/g,"&gt;")} </a>`;return console.log("file mapping: ",l,S),console.log("file mapping: ",F),console.log("file mapping: ",l.path),{id:l.path,name:l.name,nameHtml:S,path:l.path,version:l.version||"",title:l.title||l.name,size:l.size,modified:l.modified,extension:M}});a?(this.selectedFolder=null,this.selectedFolderName=null):(this.selectedFolder=i,this.selectedFolderName=r[r.length-1]||i),this.filesMap[i]=n,this.filesTableConfig=P(E({},this.filesTableConfig),{data:n})},error:t=>{console.error(t),this.folders=[],this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]})}})}createFolder(){let e=(this.newFolderName||"").trim();if(!e){b.default.fire("Error","Ingrese un nombre de carpeta v\xE1lido.","error");return}let t=`${this.currentPath}/${e}`;this.OymService.CrearCarpetaMPPs({subpath:t}).subscribe({next:i=>{i&&i.success?(b.default.fire("\xA1\xC9xito!","Carpeta creada correctamente","success"),this.newFolderName="",this.loadPath(this.currentPath)):b.default.fire("Error",i?.message||"No se pudo crear la carpeta","error")},error:i=>{console.error(i);let r=i?.error?.message||"Error al crear carpeta";b.default.fire("Error",r,"error")}})}selectFolder(e){this.pathStack.push(e),this.loadPath(e)}goBackToDepartments(){this.pathStack=["manuales_de_funciones"],this.currentPath="manuales_de_funciones",this.loadPath("manuales_de_funciones")}deleteFolder(e,t){e&&e.stopPropagation&&e.stopPropagation(),t&&b.default.fire({title:"\xBFEliminar carpeta?",html:`Eliminar carpeta "${t}"? Esta acci\xF3n tambi\xE9n eliminar\xE1 su contenido.`,icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.OymService.EliminarCarpetaMPPs({subpath:t}).subscribe({next:r=>{r&&r.success?(b.default.fire("\xA1Eliminada!","Carpeta eliminada correctamente","success"),this.loadPath(this.currentPath),this.selectedFolder===t&&(this.selectedFolder=null,this.selectedFolderName=null,this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]}))):b.default.fire("Error",r?.message||"No se pudo eliminar la carpeta","error")},error:r=>{console.error(r);let a=r?.error?.message||"Error al eliminar carpeta";b.default.fire("Error",a,"error")}})})}onCustomAction(e){if(!(!e||!e.action))switch(e.action){case"add_file":this.showAddFileModal();break;default:break}}showAddFileModal(){if(!this.selectedFolder){b.default.fire("Error","Selecciona una carpeta primero","error");return}b.default.fire({title:"Agregar Archivo",html:`
        <div class="mb-3">
          <label class="form-label">Archivo</label>
          <input id="swal-input-file" type="file" class="form-control" />
        </div>
        <div class="mb-3">
          <label class="form-label">Versi\xF3n</label>
          <input id="swal-input-version" class="form-control" placeholder="1.0">
        </div>
        <div class="mb-3">
          <label class="form-label">T\xEDtulo</label>
          <input id="swal-input-title" class="form-control" placeholder="Manual de Funciones v1">
        </div>
      `,showCancelButton:!0,confirmButtonText:"Guardar",cancelButtonText:"Cancelar",confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",focusConfirm:!1,preConfirm:()=>{let e=document.getElementById("swal-input-file"),t=document.getElementById("swal-input-version").value,i=document.getElementById("swal-input-title").value;if(!e||!e.files||e.files.length===0)return b.default.showValidationMessage("Debes seleccionar un archivo"),!1;if(!t||!i)return b.default.showValidationMessage("Versi\xF3n y T\xEDtulo son requeridos"),!1;let r=e.files[0],n=(r.name||"file").replace(/\.[^/.]+$/,"");return{file:r,name:n,version:t,title:i}}}).then(e=>{if(e.isConfirmed&&e.value){let t=e.value,i=t.file,r={name:t.name,version:t.version,title:t.title},a=this.selectedFolder||"";this.OymService.GuardarArchivoMPPs(i,a,r).subscribe({next:n=>{n&&n.success?(b.default.fire("\xA1\xC9xito!","Archivo guardado correctamente","success"),this.selectedFolder?this.selectFolder(this.selectedFolder):this.loadPath(this.currentPath)):b.default.fire("Error",n&&n.message?n.message:"No se pudo guardar el archivo","error")},error:n=>{console.error(n),b.default.fire("Error","Error al subir archivo","error")}})}}).catch(e=>{console.error("Error leyendo archivo:",e),b.default.fire("Error","No se pudo leer el archivo","error")})}onFileTableAction(e){if(!e||!e.action_to_perform)return;let t=e.data;switch(e.action_to_perform){case"edit_file":this.editFile(t);break;case"delete_file":this.deleteFile(t);break;default:}}editFile(e){e&&b.default.fire({title:"Editar Archivo",html:`
      <div class="mb-3">
        <label class="form-label">Archivo (opcional, para reemplazar)</label>
        <input id="swal-input-file" type="file" class="form-control" />
      </div>
      <div class="mb-3">
        <label class="form-label">Versi\xF3n</label>
        <input id="swal-input-version" class="form-control" value="${e.version||""}" placeholder="1.0">
      </div>
      <div class="mb-3">
        <label class="form-label">T\xEDtulo</label>
        <input id="swal-input-title" class="form-control" value="${e.title||""}" placeholder="Manual de Funciones v1">
      </div>
    `,showCancelButton:!0,confirmButtonText:"Guardar cambios",cancelButtonText:"Cancelar",confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",focusConfirm:!1,preConfirm:()=>{let t=document.getElementById("swal-input-file"),i=document.getElementById("swal-input-version"),r=document.getElementById("swal-input-title"),a=(i?.value||"").trim(),n=(r?.value||"").trim(),l=t?.files&&t.files.length>0?t.files[0]:null;return!a||!n?(b.default.showValidationMessage("Versi\xF3n y T\xEDtulo son requeridos"),!1):{newFile:l,version:a,title:n}}}).then(t=>{if(!t.isConfirmed||!t.value)return;let{newFile:i,version:r,title:a}=t.value,n=(e.path||e.id||"").toString();if(!n){b.default.fire("Error","Ruta del archivo inv\xE1lida.","error");return}if(!i){this.OymService.EditarArchivoMPPs(n,n,{name:e.name,title:a,version:r}).subscribe({next:p=>{p&&p.success?(b.default.fire("\xA1\xC9xito!","Metadatos actualizados correctamente","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)):b.default.fire("Error",p?.message||"No se pudo actualizar el archivo","error")},error:p=>{console.error(p);let h=p?.error?.message||"Error al actualizar archivo";b.default.fire("Error",h,"error")}});return}let A={name:(i.name||"file").replace(/\.[^/.]+$/,""),title:a,version:r},F=n.lastIndexOf("/"),S=F>=0?n.substring(0,F):this.selectedFolder||"";this.OymService.GuardarArchivoMPPs(i,S,A).subscribe({next:p=>{if(!p||!p.success){b.default.fire("Error",p?.message||"No se pudo guardar el nuevo archivo","error");return}this.OymService.EliminarArchivoMPPs(n).subscribe({next:h=>{!h||!h.success?b.default.fire("Advertencia","Nuevo archivo guardado, pero no se pudo eliminar el anterior.","warning"):b.default.fire("\xA1\xC9xito!","Archivo actualizado correctamente","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)},error:h=>{console.error(h),b.default.fire("Advertencia","Nuevo archivo guardado, pero ocurri\xF3 un error al eliminar el anterior.","warning"),this.selectedFolder&&this.selectFolder(this.selectedFolder)}})},error:p=>{console.error(p);let h=p?.error?.message||"Error al subir el nuevo archivo";b.default.fire("Error",h,"error")}})})}deleteFile(e){e&&this.selectedFolder&&b.default.fire({title:"\xBFEliminar archivo?",html:`
        <div class="text-start">
          <p>\xBFEst\xE1s seguro de eliminar el siguiente archivo?</p>
          <ul class="list-unstyled">
            <li><strong>Nombre:</strong> ${e.name}</li>
            <li><strong>Versi\xF3n:</strong> ${e.version}</li>
            <li><strong>T\xEDtulo:</strong> ${e.title}</li>
          </ul>
          <p class="text-danger">Esta acci\xF3n no se puede deshacer.</p>
        </div>
      `,icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar",confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d"}).then(t=>{if(t.isConfirmed){let i=e.path||e.id||e.name;this.OymService.EliminarArchivoMPPs(i).subscribe({next:r=>{r&&r.success?(b.default.fire("\xA1Eliminado!","El archivo ha sido eliminado.","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)):b.default.fire("Error",r&&r.message?r.message:"No se pudo eliminar archivo","error")},error:r=>{console.error(r),b.default.fire("Error","Error al eliminar archivo","error")}})}})}getIconForExt(e){let t=(e||"").toLowerCase(),i=r=>r.includes(t);return i(["pdf"])?{cls:"fa-solid fa-file-pdf text-danger",label:"PDF"}:i(["doc","docx","rtf"])?{cls:"fa-solid fa-file-word text-primary",label:"Word"}:i(["xls","xlsx","csv"])?{cls:"fa-solid fa-file-excel text-success",label:"Excel"}:i(["ppt","pptx"])?{cls:"fa-solid fa-file-powerpoint text-warning",label:"PowerPoint"}:i(["jpg","jpeg","png","gif","bmp","webp","tiff","svg"])?{cls:"fa-solid fa-file-image text-info",label:"Imagen"}:i(["txt","md","log"])?{cls:"fa-solid fa-file-lines",label:"Texto"}:i(["zip","rar","7z"])?{cls:"fa-solid fa-file-zipper",label:"Comprimido"}:i(["json","xml","yml","yaml"])?{cls:"fa-solid fa-file-code",label:"C\xF3digo"}:{cls:"fa-solid fa-file",label:"Archivo"}}static \u0275fac=function(t){return new(t||o)(I(k),I(L),I(q))};static \u0275cmp=O({type:o,selectors:[["app-manuales_de_funciones"]],decls:16,vars:10,consts:[[1,"container-fluid","customer-order-wrapper"],[1,"row"],[1,"col-12"],[3,"headerTitle","cardClass"],["class","row mb-3",4,"ngIf"],[1,"col-md-6","mb-2"],["class","btn btn-outline-secondary",3,"click",4,"ngIf"],[1,"customer-order-report","table-responsive","custom-scrollbar"],["class","col-md-4",4,"ngIf"],[3,"ngClass"],[1,"mb-3"],[4,"ngIf"],["class","p-3 text-muted",4,"ngIf"],[1,"row","mb-3"],[1,"input-group"],["type","text","placeholder","Nombre de la nueva carpeta",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-append","ms-4"],["type","button",1,"btn","btn-primary",3,"click"],[1,"btn","btn-outline-secondary",3,"click"],[1,"col-md-4"],["class","p-3",4,"ngIf"],["class","list-group",4,"ngIf"],[1,"p-3"],[1,"list-group"],["class","list-group-item d-flex align-items-center","style","cursor:pointer;",3,"active","click",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","align-items-center",2,"cursor","pointer",3,"click"],[1,"flex-grow-1","text-truncate",3,"title"],[1,"fa","fa-folder","me-2"],[1,"text-muted","small"],["type","button",1,"btn","btn-sm","p-0",3,"click"],[1,"fa","fa-trash"],[1,"text-primary"],[1,"p-3","text-muted"],[3,"action","customAction","hasCheckbox","tableConfig","pageSize","paginateDetails","selectedRows","downloadReports","customButtons"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-card",3),y(4,ve,7,1,"div",4),s(5,"div",5),y(6,be,2,0,"button",6),d(),s(7,"div",7)(8,"div",1),y(9,ye,6,2,"div",8),s(10,"div",9)(11,"div",10),y(12,we,2,0,"h6",11)(13,Fe,4,1,"h6",11)(14,Ee,2,0,"div",12)(15,Pe,2,7,"div",11),d()()()()()()()()),t&2&&(c(3),m("headerTitle","")("cardClass","mb-4"),c(),m("ngIf",i.canCreateFolder),c(2),m("ngIf",i.isAdmin&&!i.showFoldersPanel),c(3),m("ngIf",i.showFoldersPanel),c(),m("ngClass",i.showFoldersPanel?"col-md-8":"col-md-12"),c(2),m("ngIf",!i.selectedFolder),c(),m("ngIf",i.selectedFolder),c(),m("ngIf",!i.selectedFolder),c(),m("ngIf",i.selectedFolder))},dependencies:[G,j,W,U,X,J,K,Q,Y,Z],encapsulation:2})};var _=ee(te());function Te(o,e){if(o&1){let t=T();s(0,"div",13)(1,"div",5)(2,"div",14)(3,"input",15),H("ngModelChange",function(r){g(t);let a=u();return R(a.newFolderName,r)||(a.newFolderName=r),v(r)}),d(),s(4,"div",16)(5,"button",17),w("click",function(){g(t);let r=u();return v(r.createFolder())}),f(6,"Crear carpeta"),d()()()()()}if(o&2){let t=u();c(3),z("ngModel",t.newFolderName)}}function Se(o,e){if(o&1){let t=T();s(0,"button",18),w("click",function(){g(t);let r=u();return v(r.goBackToDepartments())}),f(1,"\u2190 Volver a departamentos"),d()}}function Ie(o,e){o&1&&(s(0,"div",22),f(1,"No hay carpetas."),d())}function Me(o,e){if(o&1){let t=T();s(0,"li",25),w("click",function(){let r=g(t).$implicit,a=u(3);return v(a.selectFolder(r.path))}),s(1,"div",26),N(2,"i",27),f(3),d(),s(4,"div",28),f(5),d(),s(6,"div")(7,"button",29),w("click",function(r){let a=g(t).$implicit,n=u(3);return v(n.deleteFolder(r,a.path))}),N(8,"i",30),d()()()}if(o&2){let t=e.$implicit,i=u(3);D("active",i.selectedFolder===t.path),c(),m("title",t.name),c(2),B(" ",t.name," "),c(2),B("",(i.filesMap[t.path]==null?null:i.filesMap[t.path].length)||0," archivos")}}function Ae(o,e){if(o&1&&(s(0,"ul",23),y(1,Me,9,5,"li",24),d()),o&2){let t=u(2);c(),m("ngForOf",t.folders)}}function Ne(o,e){if(o&1&&(s(0,"div",19)(1,"div",10)(2,"h6"),f(3,"Carpetas"),d(),y(4,Ie,2,0,"div",20)(5,Ae,2,1,"ul",21),d()()),o&2){let t=u();c(4),m("ngIf",t.folders.length===0),c(),m("ngIf",t.folders.length>0)}}function Be(o,e){o&1&&(s(0,"h6"),f(1,"Archivos"),d())}function Ve(o,e){if(o&1&&(s(0,"h6"),f(1,"Archivos en: "),s(2,"small",31),f(3),d()()),o&2){let t=u();c(3),$(t.selectedFolderName)}}function ke(o,e){o&1&&(s(0,"div",32),f(1,"Selecciona una carpeta a la izquierda para ver su contenido."),d())}function Oe(o,e){if(o&1){let t=T();s(0,"div")(1,"app-table",33),w("action",function(r){g(t);let a=u();return v(a.onFileTableAction(r))})("customAction",function(r){g(t);let a=u();return v(a.onCustomAction(r))}),d()()}if(o&2){let t=u();c(),m("hasCheckbox",!1)("tableConfig",t.filesTableConfig)("pageSize",10)("paginateDetails",!0)("selectedRows",!0)("downloadReports",!1)("customButtons",t.customButtons)}}var ne=class o{constructor(e,t,i){this.OymService=e;this.cdr=t;this.router=i}newFolderName="";folders=[];selectedFiles=[];selectedFolder=null;selectedFolderName=null;filesMap={};currentPath="procedimientos";pathStack=["procedimientos"];isAdmin=!1;get showFoldersPanel(){return this.isAdmin?(this.currentPath||"").split("/").filter(Boolean).length===1:!1}get canCreateFolder(){return this.isAdmin&&this.showFoldersPanel}customButtons=[{label:"",action:"add_file",icon:"fa fa-plus",class:"btn btn-success",tooltip:"Agregar nuevo archivo"}];filesTableConfig={columns:[{title:"Nombre",field_value:"nameHtml",sort:!0},{title:"Version",field_value:"version",sort:!0},{title:"Titulo",field_value:"title",sort:!0}],row_action:[{label:"",action_to_perform:"edit_file",icon:"edit",type:"button",class:"btn btn-light btn-sm",tooltip:"Editar"},{label:"",action_to_perform:"delete_file",icon:"trash",type:"button",class:"btn btn-danger btn-sm",tooltip:"Eliminar"}],data:[]};ngOnInit(){this.loadUserRole(),this.getDepartments(),this.loadPath(this.currentPath)}loadUserRole(){try{let e=localStorage.getItem("user");if(!e)return;let t=JSON.parse(e);this.isAdmin=t?.is_admin==="1"}catch{this.isAdmin=!1}}getDepartments(){this.OymService.getDepartamentos().subscribe({next:e=>{console.log("Departamentos:",e||[])},error:e=>{console.error(e)}})}loadPath(e){this.OymService.CargarCarpetaMPPs({subpath:e}).subscribe({next:t=>{if(!t||!t.success){this.folders=[],this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]}),this.selectedFolder=null,this.selectedFolderName=null;return}let i=t.currentPath||e||"procedimientos";this.currentPath=i;let r=(i||"").split("/").filter(Boolean),a=r.length===1;this.folders=(t.folders||[]).map(l=>({name:l.name,path:l.path||l.name}));let n=(t.files||[]).map(l=>{let M=(l.extension||"").toLowerCase(),A=this.getIconForExt(M),F=`${V.sgo_docs_base}/${l.path.split("/").map(encodeURIComponent).join("/")}`,S=`<i class="${A.cls} me-2"></i> <a href="${F}" download target="_blank" rel="noopener"> ${(l.name||"").replace(/</g,"&lt;").replace(/>/g,"&gt;")} </a>`;return console.log("file mapping: ",l,S),console.log("file mapping: ",F),console.log("file mapping: ",l.path),{id:l.path,name:l.name,nameHtml:S,path:l.path,version:l.version||"",title:l.title||l.name,size:l.size,modified:l.modified,extension:M}});a?(this.selectedFolder=null,this.selectedFolderName=null):(this.selectedFolder=i,this.selectedFolderName=r[r.length-1]||i),this.filesMap[i]=n,this.filesTableConfig=P(E({},this.filesTableConfig),{data:n})},error:t=>{console.error(t),this.folders=[],this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]})}})}createFolder(){let e=(this.newFolderName||"").trim();if(!e){_.default.fire("Error","Ingrese un nombre de carpeta v\xE1lido.","error");return}let t=`${this.currentPath}/${e}`;this.OymService.CrearCarpetaMPPs({subpath:t}).subscribe({next:i=>{i&&i.success?(_.default.fire("\xA1\xC9xito!","Carpeta creada correctamente","success"),this.newFolderName="",this.loadPath(this.currentPath)):_.default.fire("Error",i?.message||"No se pudo crear la carpeta","error")},error:i=>{console.error(i);let r=i?.error?.message||"Error al crear carpeta";_.default.fire("Error",r,"error")}})}selectFolder(e){this.pathStack.push(e),this.loadPath(e)}goBackToDepartments(){this.pathStack=["procedimientos"],this.currentPath="procedimientos",this.loadPath("procedimientos")}deleteFolder(e,t){e&&e.stopPropagation&&e.stopPropagation(),t&&_.default.fire({title:"\xBFEliminar carpeta?",html:`Eliminar carpeta "${t}"? Esta acci\xF3n tambi\xE9n eliminar\xE1 su contenido.`,icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.OymService.EliminarCarpetaMPPs({subpath:t}).subscribe({next:r=>{r&&r.success?(_.default.fire("\xA1Eliminada!","Carpeta eliminada correctamente","success"),this.loadPath(this.currentPath),this.selectedFolder===t&&(this.selectedFolder=null,this.selectedFolderName=null,this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]}))):_.default.fire("Error",r?.message||"No se pudo eliminar la carpeta","error")},error:r=>{console.error(r);let a=r?.error?.message||"Error al eliminar carpeta";_.default.fire("Error",a,"error")}})})}onCustomAction(e){if(!(!e||!e.action))switch(e.action){case"add_file":this.showAddFileModal();break;default:break}}showAddFileModal(){if(!this.selectedFolder){_.default.fire("Error","Selecciona una carpeta primero","error");return}_.default.fire({title:"Agregar Archivo",html:`
        <div class="mb-3">
          <label class="form-label">Archivo</label>
          <input id="swal-input-file" type="file" class="form-control" />
        </div>
        <div class="mb-3">
          <label class="form-label">Versi\xF3n</label>
          <input id="swal-input-version" class="form-control" placeholder="1.0">
        </div>
        <div class="mb-3">
          <label class="form-label">T\xEDtulo</label>
          <input id="swal-input-title" class="form-control" placeholder="Procedimientos v1">
        </div>
      `,showCancelButton:!0,confirmButtonText:"Guardar",cancelButtonText:"Cancelar",confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",focusConfirm:!1,preConfirm:()=>{let e=document.getElementById("swal-input-file"),t=document.getElementById("swal-input-version").value,i=document.getElementById("swal-input-title").value;if(!e||!e.files||e.files.length===0)return _.default.showValidationMessage("Debes seleccionar un archivo"),!1;if(!t||!i)return _.default.showValidationMessage("Versi\xF3n y T\xEDtulo son requeridos"),!1;let r=e.files[0],n=(r.name||"file").replace(/\.[^/.]+$/,"");return{file:r,name:n,version:t,title:i}}}).then(e=>{if(e.isConfirmed&&e.value){let t=e.value,i=t.file,r={name:t.name,version:t.version,title:t.title},a=this.selectedFolder||"";this.OymService.GuardarArchivoMPPs(i,a,r).subscribe({next:n=>{n&&n.success?(_.default.fire("\xA1\xC9xito!","Archivo guardado correctamente","success"),this.selectedFolder?this.selectFolder(this.selectedFolder):this.loadPath(this.currentPath)):_.default.fire("Error",n&&n.message?n.message:"No se pudo guardar el archivo","error")},error:n=>{console.error(n),_.default.fire("Error","Error al subir archivo","error")}})}}).catch(e=>{console.error("Error leyendo archivo:",e),_.default.fire("Error","No se pudo leer el archivo","error")})}onFileTableAction(e){if(!e||!e.action_to_perform)return;let t=e.data;switch(e.action_to_perform){case"edit_file":this.editFile(t);break;case"delete_file":this.deleteFile(t);break;default:}}editFile(e){e&&_.default.fire({title:"Editar Archivo",html:`
      <div class="mb-3">
        <label class="form-label">Archivo (opcional, para reemplazar)</label>
        <input id="swal-input-file" type="file" class="form-control" />
      </div>
      <div class="mb-3">
        <label class="form-label">Versi\xF3n</label>
        <input id="swal-input-version" class="form-control" value="${e.version||""}" placeholder="1.0">
      </div>
      <div class="mb-3">
        <label class="form-label">T\xEDtulo</label>
        <input id="swal-input-title" class="form-control" value="${e.title||""}" placeholder="Procedimientos v1">
      </div>
    `,showCancelButton:!0,confirmButtonText:"Guardar cambios",cancelButtonText:"Cancelar",confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",focusConfirm:!1,preConfirm:()=>{let t=document.getElementById("swal-input-file"),i=document.getElementById("swal-input-version"),r=document.getElementById("swal-input-title"),a=(i?.value||"").trim(),n=(r?.value||"").trim(),l=t?.files&&t.files.length>0?t.files[0]:null;return!a||!n?(_.default.showValidationMessage("Versi\xF3n y T\xEDtulo son requeridos"),!1):{newFile:l,version:a,title:n}}}).then(t=>{if(!t.isConfirmed||!t.value)return;let{newFile:i,version:r,title:a}=t.value,n=(e.path||e.id||"").toString();if(!n){_.default.fire("Error","Ruta del archivo inv\xE1lida.","error");return}if(!i){this.OymService.EditarArchivoMPPs(n,n,{name:e.name,title:a,version:r}).subscribe({next:p=>{p&&p.success?(_.default.fire("\xA1\xC9xito!","Metadatos actualizados correctamente","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)):_.default.fire("Error",p?.message||"No se pudo actualizar el archivo","error")},error:p=>{console.error(p);let h=p?.error?.message||"Error al actualizar archivo";_.default.fire("Error",h,"error")}});return}let A={name:(i.name||"file").replace(/\.[^/.]+$/,""),title:a,version:r},F=n.lastIndexOf("/"),S=F>=0?n.substring(0,F):this.selectedFolder||"";this.OymService.GuardarArchivoMPPs(i,S,A).subscribe({next:p=>{if(!p||!p.success){_.default.fire("Error",p?.message||"No se pudo guardar el nuevo archivo","error");return}this.OymService.EliminarArchivoMPPs(n).subscribe({next:h=>{!h||!h.success?_.default.fire("Advertencia","Nuevo archivo guardado, pero no se pudo eliminar el anterior.","warning"):_.default.fire("\xA1\xC9xito!","Archivo actualizado correctamente","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)},error:h=>{console.error(h),_.default.fire("Advertencia","Nuevo archivo guardado, pero ocurri\xF3 un error al eliminar el anterior.","warning"),this.selectedFolder&&this.selectFolder(this.selectedFolder)}})},error:p=>{console.error(p);let h=p?.error?.message||"Error al subir el nuevo archivo";_.default.fire("Error",h,"error")}})})}deleteFile(e){e&&this.selectedFolder&&_.default.fire({title:"\xBFEliminar archivo?",html:`
        <div class="text-start">
          <p>\xBFEst\xE1s seguro de eliminar el siguiente archivo?</p>
          <ul class="list-unstyled">
            <li><strong>Nombre:</strong> ${e.name}</li>
            <li><strong>Versi\xF3n:</strong> ${e.version}</li>
            <li><strong>T\xEDtulo:</strong> ${e.title}</li>
          </ul>
          <p class="text-danger">Esta acci\xF3n no se puede deshacer.</p>
        </div>
      `,icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar",confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d"}).then(t=>{if(t.isConfirmed){let i=e.path||e.id||e.name;this.OymService.EliminarArchivoMPPs(i).subscribe({next:r=>{r&&r.success?(_.default.fire("\xA1Eliminado!","El archivo ha sido eliminado.","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)):_.default.fire("Error",r&&r.message?r.message:"No se pudo eliminar archivo","error")},error:r=>{console.error(r),_.default.fire("Error","Error al eliminar archivo","error")}})}})}getIconForExt(e){let t=(e||"").toLowerCase(),i=r=>r.includes(t);return i(["pdf"])?{cls:"fa-solid fa-file-pdf text-danger",label:"PDF"}:i(["doc","docx","rtf"])?{cls:"fa-solid fa-file-word text-primary",label:"Word"}:i(["xls","xlsx","csv"])?{cls:"fa-solid fa-file-excel text-success",label:"Excel"}:i(["ppt","pptx"])?{cls:"fa-solid fa-file-powerpoint text-warning",label:"PowerPoint"}:i(["jpg","jpeg","png","gif","bmp","webp","tiff","svg"])?{cls:"fa-solid fa-file-image text-info",label:"Imagen"}:i(["txt","md","log"])?{cls:"fa-solid fa-file-lines",label:"Texto"}:i(["zip","rar","7z"])?{cls:"fa-solid fa-file-zipper",label:"Comprimido"}:i(["json","xml","yml","yaml"])?{cls:"fa-solid fa-file-code",label:"C\xF3digo"}:{cls:"fa-solid fa-file",label:"Archivo"}}static \u0275fac=function(t){return new(t||o)(I(k),I(L),I(q))};static \u0275cmp=O({type:o,selectors:[["app-procedimientos"]],decls:16,vars:10,consts:[[1,"container-fluid","customer-order-wrapper"],[1,"row"],[1,"col-12"],[3,"headerTitle","cardClass"],["class","row mb-3",4,"ngIf"],[1,"col-md-6","mb-2"],["class","btn btn-outline-secondary",3,"click",4,"ngIf"],[1,"customer-order-report","table-responsive","custom-scrollbar"],["class","col-md-4",4,"ngIf"],[3,"ngClass"],[1,"mb-3"],[4,"ngIf"],["class","p-3 text-muted",4,"ngIf"],[1,"row","mb-3"],[1,"input-group"],["type","text","placeholder","Nombre de la nueva carpeta",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-append","ms-4"],["type","button",1,"btn","btn-primary",3,"click"],[1,"btn","btn-outline-secondary",3,"click"],[1,"col-md-4"],["class","p-3",4,"ngIf"],["class","list-group",4,"ngIf"],[1,"p-3"],[1,"list-group"],["class","list-group-item d-flex align-items-center","style","cursor:pointer;",3,"active","click",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","align-items-center",2,"cursor","pointer",3,"click"],[1,"flex-grow-1","text-truncate",3,"title"],[1,"fa","fa-folder","me-2"],[1,"text-muted","small"],["type","button",1,"btn","btn-sm","p-0",3,"click"],[1,"fa","fa-trash"],[1,"text-primary"],[1,"p-3","text-muted"],[3,"action","customAction","hasCheckbox","tableConfig","pageSize","paginateDetails","selectedRows","downloadReports","customButtons"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-card",3),y(4,Te,7,1,"div",4),s(5,"div",5),y(6,Se,2,0,"button",6),d(),s(7,"div",7)(8,"div",1),y(9,Ne,6,2,"div",8),s(10,"div",9)(11,"div",10),y(12,Be,2,0,"h6",11)(13,Ve,4,1,"h6",11)(14,ke,2,0,"div",12)(15,Oe,2,7,"div",11),d()()()()()()()()),t&2&&(c(3),m("headerTitle","")("cardClass","mb-4"),c(),m("ngIf",i.canCreateFolder),c(2),m("ngIf",i.isAdmin&&!i.showFoldersPanel),c(3),m("ngIf",i.showFoldersPanel),c(),m("ngClass",i.showFoldersPanel?"col-md-8":"col-md-12"),c(2),m("ngIf",!i.selectedFolder),c(),m("ngIf",i.selectedFolder),c(),m("ngIf",!i.selectedFolder),c(),m("ngIf",i.selectedFolder))},dependencies:[G,j,W,U,X,J,K,Q,Y,Z],encapsulation:2})};var C=ee(te());function De(o,e){if(o&1){let t=T();s(0,"div",13)(1,"div",5)(2,"div",14)(3,"input",15),H("ngModelChange",function(r){g(t);let a=u();return R(a.newFolderName,r)||(a.newFolderName=r),v(r)}),d(),s(4,"div",16)(5,"button",17),w("click",function(){g(t);let r=u();return v(r.createFolder())}),f(6,"Crear carpeta"),d()()()()()}if(o&2){let t=u();c(3),z("ngModel",t.newFolderName)}}function $e(o,e){if(o&1){let t=T();s(0,"button",18),w("click",function(){g(t);let r=u();return v(r.goBackToDepartments())}),f(1,"\u2190 Volver a departamentos"),d()}}function ze(o,e){o&1&&(s(0,"div",22),f(1,"No hay carpetas."),d())}function Re(o,e){if(o&1){let t=T();s(0,"li",25),w("click",function(){let r=g(t).$implicit,a=u(3);return v(a.selectFolder(r.path))}),s(1,"div",26),N(2,"i",27),f(3),d(),s(4,"div",28),f(5),d(),s(6,"div")(7,"button",29),w("click",function(r){let a=g(t).$implicit,n=u(3);return v(n.deleteFolder(r,a.path))}),N(8,"i",30),d()()()}if(o&2){let t=e.$implicit,i=u(3);D("active",i.selectedFolder===t.path),c(),m("title",t.name),c(2),B(" ",t.name," "),c(2),B("",(i.filesMap[t.path]==null?null:i.filesMap[t.path].length)||0," archivos")}}function He(o,e){if(o&1&&(s(0,"ul",23),y(1,Re,9,5,"li",24),d()),o&2){let t=u(2);c(),m("ngForOf",t.folders)}}function Le(o,e){if(o&1&&(s(0,"div",19)(1,"div",10)(2,"h6"),f(3,"Carpetas"),d(),y(4,ze,2,0,"div",20)(5,He,2,1,"ul",21),d()()),o&2){let t=u();c(4),m("ngIf",t.folders.length===0),c(),m("ngIf",t.folders.length>0)}}function je(o,e){o&1&&(s(0,"h6"),f(1,"Archivos"),d())}function We(o,e){if(o&1&&(s(0,"h6"),f(1,"Archivos en: "),s(2,"small",31),f(3),d()()),o&2){let t=u();c(3),$(t.selectedFolderName)}}function Ue(o,e){o&1&&(s(0,"div",32),f(1,"Selecciona una carpeta a la izquierda para ver su contenido."),d())}function Ge(o,e){if(o&1){let t=T();s(0,"div")(1,"app-table",33),w("action",function(r){g(t);let a=u();return v(a.onFileTableAction(r))})("customAction",function(r){g(t);let a=u();return v(a.onCustomAction(r))}),d()()}if(o&2){let t=u();c(),m("hasCheckbox",!1)("tableConfig",t.filesTableConfig)("pageSize",10)("paginateDetails",!0)("selectedRows",!0)("downloadReports",!1)("customButtons",t.customButtons)}}var ae=class o{constructor(e,t,i){this.OymService=e;this.cdr=t;this.router=i}newFolderName="";folders=[];selectedFiles=[];selectedFolder=null;selectedFolderName=null;filesMap={};currentPath="politicas";pathStack=["politicas"];isAdmin=!1;get showFoldersPanel(){return this.isAdmin?(this.currentPath||"").split("/").filter(Boolean).length===1:!1}get canCreateFolder(){return this.isAdmin&&this.showFoldersPanel}customButtons=[{label:"",action:"add_file",icon:"fa fa-plus",class:"btn btn-success",tooltip:"Agregar nuevo archivo"}];filesTableConfig={columns:[{title:"Nombre",field_value:"nameHtml",sort:!0},{title:"Version",field_value:"version",sort:!0},{title:"Titulo",field_value:"title",sort:!0}],row_action:[{label:"",action_to_perform:"edit_file",icon:"edit",type:"button",class:"btn btn-light btn-sm",tooltip:"Editar"},{label:"",action_to_perform:"delete_file",icon:"trash",type:"button",class:"btn btn-danger btn-sm",tooltip:"Eliminar"}],data:[]};ngOnInit(){this.loadUserRole(),this.getDepartments(),this.loadPath(this.currentPath)}loadUserRole(){try{let e=localStorage.getItem("user");if(!e)return;let t=JSON.parse(e);this.isAdmin=t?.is_admin==="1"}catch{this.isAdmin=!1}}getDepartments(){this.OymService.getDepartamentos().subscribe({next:e=>{console.log("Departamentos:",e||[])},error:e=>{console.error(e)}})}loadPath(e){this.OymService.CargarCarpetaMPPs({subpath:e}).subscribe({next:t=>{if(!t||!t.success){this.folders=[],this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]}),this.selectedFolder=null,this.selectedFolderName=null;return}let i=t.currentPath||e||"politicas";this.currentPath=i;let r=(i||"").split("/").filter(Boolean),a=r.length===1;this.folders=(t.folders||[]).map(l=>({name:l.name,path:l.path||l.name}));let n=(t.files||[]).map(l=>{let M=(l.extension||"").toLowerCase(),A=this.getIconForExt(M),F=`${V.sgo_docs_base}/${l.path.split("/").map(encodeURIComponent).join("/")}`,S=`<i class="${A.cls} me-2"></i> <a href="${F}" download target="_blank" rel="noopener"> ${(l.name||"").replace(/</g,"&lt;").replace(/>/g,"&gt;")} </a>`;return console.log("file mapping: ",l,S),console.log("file mapping: ",F),console.log("file mapping: ",l.path),{id:l.path,name:l.name,nameHtml:S,path:l.path,version:l.version||"",title:l.title||l.name,size:l.size,modified:l.modified,extension:M}});a?(this.selectedFolder=null,this.selectedFolderName=null):(this.selectedFolder=i,this.selectedFolderName=r[r.length-1]||i),this.filesMap[i]=n,this.filesTableConfig=P(E({},this.filesTableConfig),{data:n})},error:t=>{console.error(t),this.folders=[],this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]})}})}createFolder(){let e=(this.newFolderName||"").trim();if(!e){C.default.fire("Error","Ingrese un nombre de carpeta v\xE1lido.","error");return}let t=`${this.currentPath}/${e}`;this.OymService.CrearCarpetaMPPs({subpath:t}).subscribe({next:i=>{i&&i.success?(C.default.fire("\xA1\xC9xito!","Carpeta creada correctamente","success"),this.newFolderName="",this.loadPath(this.currentPath)):C.default.fire("Error",i?.message||"No se pudo crear la carpeta","error")},error:i=>{console.error(i);let r=i?.error?.message||"Error al crear carpeta";C.default.fire("Error",r,"error")}})}selectFolder(e){this.pathStack.push(e),this.loadPath(e)}goBackToDepartments(){this.pathStack=["politicas"],this.currentPath="politicas",this.loadPath("politicas")}deleteFolder(e,t){e&&e.stopPropagation&&e.stopPropagation(),t&&C.default.fire({title:"\xBFEliminar carpeta?",html:`Eliminar carpeta "${t}"? Esta acci\xF3n tambi\xE9n eliminar\xE1 su contenido.`,icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.OymService.EliminarCarpetaMPPs({subpath:t}).subscribe({next:r=>{r&&r.success?(C.default.fire("\xA1Eliminada!","Carpeta eliminada correctamente","success"),this.loadPath(this.currentPath),this.selectedFolder===t&&(this.selectedFolder=null,this.selectedFolderName=null,this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]}))):C.default.fire("Error",r?.message||"No se pudo eliminar la carpeta","error")},error:r=>{console.error(r);let a=r?.error?.message||"Error al eliminar carpeta";C.default.fire("Error",a,"error")}})})}onCustomAction(e){if(!(!e||!e.action))switch(e.action){case"add_file":this.showAddFileModal();break;default:break}}showAddFileModal(){if(!this.selectedFolder){C.default.fire("Error","Selecciona una carpeta primero","error");return}C.default.fire({title:"Agregar Archivo",html:`
        <div class="mb-3">
          <label class="form-label">Archivo</label>
          <input id="swal-input-file" type="file" class="form-control" />
        </div>
        <div class="mb-3">
          <label class="form-label">Versi\xF3n</label>
          <input id="swal-input-version" class="form-control" placeholder="1.0">
        </div>
        <div class="mb-3">
          <label class="form-label">T\xEDtulo</label>
          <input id="swal-input-title" class="form-control" placeholder="Politicas v1">
        </div>
      `,showCancelButton:!0,confirmButtonText:"Guardar",cancelButtonText:"Cancelar",confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",focusConfirm:!1,preConfirm:()=>{let e=document.getElementById("swal-input-file"),t=document.getElementById("swal-input-version").value,i=document.getElementById("swal-input-title").value;if(!e||!e.files||e.files.length===0)return C.default.showValidationMessage("Debes seleccionar un archivo"),!1;if(!t||!i)return C.default.showValidationMessage("Versi\xF3n y T\xEDtulo son requeridos"),!1;let r=e.files[0],n=(r.name||"file").replace(/\.[^/.]+$/,"");return{file:r,name:n,version:t,title:i}}}).then(e=>{if(e.isConfirmed&&e.value){let t=e.value,i=t.file,r={name:t.name,version:t.version,title:t.title},a=this.selectedFolder||"";this.OymService.GuardarArchivoMPPs(i,a,r).subscribe({next:n=>{n&&n.success?(C.default.fire("\xA1\xC9xito!","Archivo guardado correctamente","success"),this.selectedFolder?this.selectFolder(this.selectedFolder):this.loadPath(this.currentPath)):C.default.fire("Error",n&&n.message?n.message:"No se pudo guardar el archivo","error")},error:n=>{console.error(n),C.default.fire("Error","Error al subir archivo","error")}})}}).catch(e=>{console.error("Error leyendo archivo:",e),C.default.fire("Error","No se pudo leer el archivo","error")})}onFileTableAction(e){if(!e||!e.action_to_perform)return;let t=e.data;switch(e.action_to_perform){case"edit_file":this.editFile(t);break;case"delete_file":this.deleteFile(t);break;default:}}editFile(e){e&&C.default.fire({title:"Editar Archivo",html:`
      <div class="mb-3">
        <label class="form-label">Archivo (opcional, para reemplazar)</label>
        <input id="swal-input-file" type="file" class="form-control" />
      </div>
      <div class="mb-3">
        <label class="form-label">Versi\xF3n</label>
        <input id="swal-input-version" class="form-control" value="${e.version||""}" placeholder="1.0">
      </div>
      <div class="mb-3">
        <label class="form-label">T\xEDtulo</label>
        <input id="swal-input-title" class="form-control" value="${e.title||""}" placeholder="Politicas v1">
      </div>
    `,showCancelButton:!0,confirmButtonText:"Guardar cambios",cancelButtonText:"Cancelar",confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",focusConfirm:!1,preConfirm:()=>{let t=document.getElementById("swal-input-file"),i=document.getElementById("swal-input-version"),r=document.getElementById("swal-input-title"),a=(i?.value||"").trim(),n=(r?.value||"").trim(),l=t?.files&&t.files.length>0?t.files[0]:null;return!a||!n?(C.default.showValidationMessage("Versi\xF3n y T\xEDtulo son requeridos"),!1):{newFile:l,version:a,title:n}}}).then(t=>{if(!t.isConfirmed||!t.value)return;let{newFile:i,version:r,title:a}=t.value,n=(e.path||e.id||"").toString();if(!n){C.default.fire("Error","Ruta del archivo inv\xE1lida.","error");return}if(!i){this.OymService.EditarArchivoMPPs(n,n,{name:e.name,title:a,version:r}).subscribe({next:p=>{p&&p.success?(C.default.fire("\xA1\xC9xito!","Metadatos actualizados correctamente","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)):C.default.fire("Error",p?.message||"No se pudo actualizar el archivo","error")},error:p=>{console.error(p);let h=p?.error?.message||"Error al actualizar archivo";C.default.fire("Error",h,"error")}});return}let A={name:(i.name||"file").replace(/\.[^/.]+$/,""),title:a,version:r},F=n.lastIndexOf("/"),S=F>=0?n.substring(0,F):this.selectedFolder||"";this.OymService.GuardarArchivoMPPs(i,S,A).subscribe({next:p=>{if(!p||!p.success){C.default.fire("Error",p?.message||"No se pudo guardar el nuevo archivo","error");return}this.OymService.EliminarArchivoMPPs(n).subscribe({next:h=>{!h||!h.success?C.default.fire("Advertencia","Nuevo archivo guardado, pero no se pudo eliminar el anterior.","warning"):C.default.fire("\xA1\xC9xito!","Archivo actualizado correctamente","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)},error:h=>{console.error(h),C.default.fire("Advertencia","Nuevo archivo guardado, pero ocurri\xF3 un error al eliminar el anterior.","warning"),this.selectedFolder&&this.selectFolder(this.selectedFolder)}})},error:p=>{console.error(p);let h=p?.error?.message||"Error al subir el nuevo archivo";C.default.fire("Error",h,"error")}})})}deleteFile(e){e&&this.selectedFolder&&C.default.fire({title:"\xBFEliminar archivo?",html:`
        <div class="text-start">
          <p>\xBFEst\xE1s seguro de eliminar el siguiente archivo?</p>
          <ul class="list-unstyled">
            <li><strong>Nombre:</strong> ${e.name}</li>
            <li><strong>Versi\xF3n:</strong> ${e.version}</li>
            <li><strong>T\xEDtulo:</strong> ${e.title}</li>
          </ul>
          <p class="text-danger">Esta acci\xF3n no se puede deshacer.</p>
        </div>
      `,icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar",confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d"}).then(t=>{if(t.isConfirmed){let i=e.path||e.id||e.name;this.OymService.EliminarArchivoMPPs(i).subscribe({next:r=>{r&&r.success?(C.default.fire("\xA1Eliminado!","El archivo ha sido eliminado.","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)):C.default.fire("Error",r&&r.message?r.message:"No se pudo eliminar archivo","error")},error:r=>{console.error(r),C.default.fire("Error","Error al eliminar archivo","error")}})}})}getIconForExt(e){let t=(e||"").toLowerCase(),i=r=>r.includes(t);return i(["pdf"])?{cls:"fa-solid fa-file-pdf text-danger",label:"PDF"}:i(["doc","docx","rtf"])?{cls:"fa-solid fa-file-word text-primary",label:"Word"}:i(["xls","xlsx","csv"])?{cls:"fa-solid fa-file-excel text-success",label:"Excel"}:i(["ppt","pptx"])?{cls:"fa-solid fa-file-powerpoint text-warning",label:"PowerPoint"}:i(["jpg","jpeg","png","gif","bmp","webp","tiff","svg"])?{cls:"fa-solid fa-file-image text-info",label:"Imagen"}:i(["txt","md","log"])?{cls:"fa-solid fa-file-lines",label:"Texto"}:i(["zip","rar","7z"])?{cls:"fa-solid fa-file-zipper",label:"Comprimido"}:i(["json","xml","yml","yaml"])?{cls:"fa-solid fa-file-code",label:"C\xF3digo"}:{cls:"fa-solid fa-file",label:"Archivo"}}static \u0275fac=function(t){return new(t||o)(I(k),I(L),I(q))};static \u0275cmp=O({type:o,selectors:[["app-politicas"]],decls:16,vars:10,consts:[[1,"container-fluid","customer-order-wrapper"],[1,"row"],[1,"col-12"],[3,"headerTitle","cardClass"],["class","row mb-3",4,"ngIf"],[1,"col-md-6","mb-2"],["class","btn btn-outline-secondary",3,"click",4,"ngIf"],[1,"customer-order-report","table-responsive","custom-scrollbar"],["class","col-md-4",4,"ngIf"],[3,"ngClass"],[1,"mb-3"],[4,"ngIf"],["class","p-3 text-muted",4,"ngIf"],[1,"row","mb-3"],[1,"input-group"],["type","text","placeholder","Nombre de la nueva carpeta",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-append","ms-4"],["type","button",1,"btn","btn-primary",3,"click"],[1,"btn","btn-outline-secondary",3,"click"],[1,"col-md-4"],["class","p-3",4,"ngIf"],["class","list-group",4,"ngIf"],[1,"p-3"],[1,"list-group"],["class","list-group-item d-flex align-items-center","style","cursor:pointer;",3,"active","click",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","align-items-center",2,"cursor","pointer",3,"click"],[1,"flex-grow-1","text-truncate",3,"title"],[1,"fa","fa-folder","me-2"],[1,"text-muted","small"],["type","button",1,"btn","btn-sm","p-0",3,"click"],[1,"fa","fa-trash"],[1,"text-primary"],[1,"p-3","text-muted"],[3,"action","customAction","hasCheckbox","tableConfig","pageSize","paginateDetails","selectedRows","downloadReports","customButtons"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-card",3),y(4,De,7,1,"div",4),s(5,"div",5),y(6,$e,2,0,"button",6),d(),s(7,"div",7)(8,"div",1),y(9,Le,6,2,"div",8),s(10,"div",9)(11,"div",10),y(12,je,2,0,"h6",11)(13,We,4,1,"h6",11)(14,Ue,2,0,"div",12)(15,Ge,2,7,"div",11),d()()()()()()()()),t&2&&(c(3),m("headerTitle","")("cardClass","mb-4"),c(),m("ngIf",i.canCreateFolder),c(2),m("ngIf",i.isAdmin&&!i.showFoldersPanel),c(3),m("ngIf",i.showFoldersPanel),c(),m("ngClass",i.showFoldersPanel?"col-md-8":"col-md-12"),c(2),m("ngIf",!i.selectedFolder),c(),m("ngIf",i.selectedFolder),c(),m("ngIf",!i.selectedFolder),c(),m("ngIf",i.selectedFolder))},dependencies:[G,j,W,U,X,J,K,Q,Y,Z],encapsulation:2})};var x=ee(te());function qe(o,e){if(o&1){let t=T();s(0,"div",13)(1,"div",5)(2,"div",14)(3,"input",15),H("ngModelChange",function(r){g(t);let a=u();return R(a.newFolderName,r)||(a.newFolderName=r),v(r)}),d(),s(4,"div",16)(5,"button",17),w("click",function(){g(t);let r=u();return v(r.createFolder())}),f(6,"Crear carpeta"),d()()()()()}if(o&2){let t=u();c(3),z("ngModel",t.newFolderName)}}function Je(o,e){if(o&1){let t=T();s(0,"button",18),w("click",function(){g(t);let r=u();return v(r.goBackToDepartments())}),f(1,"\u2190 Volver a departamentos"),d()}}function Ke(o,e){o&1&&(s(0,"div",22),f(1,"No hay carpetas."),d())}function Qe(o,e){if(o&1){let t=T();s(0,"li",25),w("click",function(){let r=g(t).$implicit,a=u(3);return v(a.selectFolder(r.path))}),s(1,"div",26),N(2,"i",27),f(3),d(),s(4,"div",28),f(5),d(),s(6,"div")(7,"button",29),w("click",function(r){let a=g(t).$implicit,n=u(3);return v(n.deleteFolder(r,a.path))}),N(8,"i",30),d()()()}if(o&2){let t=e.$implicit,i=u(3);D("active",i.selectedFolder===t.path),c(),m("title",t.name),c(2),B(" ",t.name," "),c(2),B("",(i.filesMap[t.path]==null?null:i.filesMap[t.path].length)||0," archivos")}}function Xe(o,e){if(o&1&&(s(0,"ul",23),y(1,Qe,9,5,"li",24),d()),o&2){let t=u(2);c(),m("ngForOf",t.folders)}}function Ye(o,e){if(o&1&&(s(0,"div",19)(1,"div",10)(2,"h6"),f(3,"Carpetas"),d(),y(4,Ke,2,0,"div",20)(5,Xe,2,1,"ul",21),d()()),o&2){let t=u();c(4),m("ngIf",t.folders.length===0),c(),m("ngIf",t.folders.length>0)}}function Ze(o,e){o&1&&(s(0,"h6"),f(1,"Archivos"),d())}function et(o,e){if(o&1&&(s(0,"h6"),f(1,"Archivos en: "),s(2,"small",31),f(3),d()()),o&2){let t=u();c(3),$(t.selectedFolderName)}}function tt(o,e){o&1&&(s(0,"div",32),f(1,"Selecciona una carpeta a la izquierda para ver su contenido."),d())}function it(o,e){if(o&1){let t=T();s(0,"div")(1,"app-table",33),w("action",function(r){g(t);let a=u();return v(a.onFileTableAction(r))})("customAction",function(r){g(t);let a=u();return v(a.onCustomAction(r))}),d()()}if(o&2){let t=u();c(),m("hasCheckbox",!1)("tableConfig",t.filesTableConfig)("pageSize",10)("paginateDetails",!0)("selectedRows",!0)("downloadReports",!1)("customButtons",t.customButtons)}}var le=class o{constructor(e,t,i){this.OymService=e;this.cdr=t;this.router=i}newFolderName="";folders=[];selectedFiles=[];selectedFolder=null;selectedFolderName=null;filesMap={};currentPath="contratos";pathStack=["contratos"];isAdmin=!1;get showFoldersPanel(){return this.isAdmin?(this.currentPath||"").split("/").filter(Boolean).length===1:!1}get canCreateFolder(){return this.isAdmin&&this.showFoldersPanel}customButtons=[{label:"",action:"add_file",icon:"fa fa-plus",class:"btn btn-success",tooltip:"Agregar nuevo archivo"}];filesTableConfig={columns:[{title:"Nombre",field_value:"nameHtml",sort:!0},{title:"Version",field_value:"version",sort:!0},{title:"Titulo",field_value:"title",sort:!0}],row_action:[{label:"",action_to_perform:"edit_file",icon:"edit",type:"button",class:"btn btn-light btn-sm",tooltip:"Editar"},{label:"",action_to_perform:"delete_file",icon:"trash",type:"button",class:"btn btn-danger btn-sm",tooltip:"Eliminar"}],data:[]};ngOnInit(){this.loadUserRole(),this.getDepartments(),this.loadPath(this.currentPath)}loadUserRole(){try{let e=localStorage.getItem("user");if(!e)return;let t=JSON.parse(e);this.isAdmin=t?.is_admin==="1"}catch{this.isAdmin=!1}}getDepartments(){this.OymService.getDepartamentos().subscribe({next:e=>{console.log("Departamentos:",e||[])},error:e=>{console.error(e)}})}loadPath(e){this.OymService.CargarCarpetaMPPs({subpath:e}).subscribe({next:t=>{if(!t||!t.success){this.folders=[],this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]}),this.selectedFolder=null,this.selectedFolderName=null;return}let i=t.currentPath||e||"contratos";this.currentPath=i;let r=(i||"").split("/").filter(Boolean),a=r.length===1;this.folders=(t.folders||[]).map(l=>({name:l.name,path:l.path||l.name}));let n=(t.files||[]).map(l=>{let M=(l.extension||"").toLowerCase(),A=this.getIconForExt(M),F=`${V.sgo_docs_base}/${l.path.split("/").map(encodeURIComponent).join("/")}`,S=`<i class="${A.cls} me-2"></i> <a href="${F}" download target="_blank" rel="noopener"> ${(l.name||"").replace(/</g,"&lt;").replace(/>/g,"&gt;")} </a>`;return console.log("file mapping: ",l,S),console.log("file mapping: ",F),console.log("file mapping: ",l.path),{id:l.path,name:l.name,nameHtml:S,path:l.path,version:l.version||"",title:l.title||l.name,size:l.size,modified:l.modified,extension:M}});a?(this.selectedFolder=null,this.selectedFolderName=null):(this.selectedFolder=i,this.selectedFolderName=r[r.length-1]||i),this.filesMap[i]=n,this.filesTableConfig=P(E({},this.filesTableConfig),{data:n})},error:t=>{console.error(t),this.folders=[],this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]})}})}createFolder(){let e=(this.newFolderName||"").trim();if(!e){x.default.fire("Error","Ingrese un nombre de carpeta v\xE1lido.","error");return}let t=`${this.currentPath}/${e}`;this.OymService.CrearCarpetaMPPs({subpath:t}).subscribe({next:i=>{i&&i.success?(x.default.fire("\xA1\xC9xito!","Carpeta creada correctamente","success"),this.newFolderName="",this.loadPath(this.currentPath)):x.default.fire("Error",i?.message||"No se pudo crear la carpeta","error")},error:i=>{console.error(i);let r=i?.error?.message||"Error al crear carpeta";x.default.fire("Error",r,"error")}})}selectFolder(e){this.pathStack.push(e),this.loadPath(e)}goBackToDepartments(){this.pathStack=["contratos"],this.currentPath="contratos",this.loadPath("contratos")}deleteFolder(e,t){e&&e.stopPropagation&&e.stopPropagation(),t&&x.default.fire({title:"\xBFEliminar carpeta?",html:`Eliminar carpeta "${t}"? Esta acci\xF3n tambi\xE9n eliminar\xE1 su contenido.`,icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar"}).then(i=>{i.isConfirmed&&this.OymService.EliminarCarpetaMPPs({subpath:t}).subscribe({next:r=>{r&&r.success?(x.default.fire("\xA1Eliminada!","Carpeta eliminada correctamente","success"),this.loadPath(this.currentPath),this.selectedFolder===t&&(this.selectedFolder=null,this.selectedFolderName=null,this.filesTableConfig=P(E({},this.filesTableConfig),{data:[]}))):x.default.fire("Error",r?.message||"No se pudo eliminar la carpeta","error")},error:r=>{console.error(r);let a=r?.error?.message||"Error al eliminar carpeta";x.default.fire("Error",a,"error")}})})}onCustomAction(e){if(!(!e||!e.action))switch(e.action){case"add_file":this.showAddFileModal();break;default:break}}showAddFileModal(){if(!this.selectedFolder){x.default.fire("Error","Selecciona una carpeta primero","error");return}x.default.fire({title:"Agregar Archivo",html:`
        <div class="mb-3">
          <label class="form-label">Archivo</label>
          <input id="swal-input-file" type="file" class="form-control" />
        </div>
        <div class="mb-3">
          <label class="form-label">Versi\xF3n</label>
          <input id="swal-input-version" class="form-control" placeholder="1.0">
        </div>
        <div class="mb-3">
          <label class="form-label">T\xEDtulo</label>
          <input id="swal-input-title" class="form-control" placeholder="Contratos v1">
        </div>
      `,showCancelButton:!0,confirmButtonText:"Guardar",cancelButtonText:"Cancelar",confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",focusConfirm:!1,preConfirm:()=>{let e=document.getElementById("swal-input-file"),t=document.getElementById("swal-input-version").value,i=document.getElementById("swal-input-title").value;if(!e||!e.files||e.files.length===0)return x.default.showValidationMessage("Debes seleccionar un archivo"),!1;if(!t||!i)return x.default.showValidationMessage("Versi\xF3n y T\xEDtulo son requeridos"),!1;let r=e.files[0],n=(r.name||"file").replace(/\.[^/.]+$/,"");return{file:r,name:n,version:t,title:i}}}).then(e=>{if(e.isConfirmed&&e.value){let t=e.value,i=t.file,r={name:t.name,version:t.version,title:t.title},a=this.selectedFolder||"";this.OymService.GuardarArchivoMPPs(i,a,r).subscribe({next:n=>{n&&n.success?(x.default.fire("\xA1\xC9xito!","Archivo guardado correctamente","success"),this.selectedFolder?this.selectFolder(this.selectedFolder):this.loadPath(this.currentPath)):x.default.fire("Error",n&&n.message?n.message:"No se pudo guardar el archivo","error")},error:n=>{console.error(n),x.default.fire("Error","Error al subir archivo","error")}})}}).catch(e=>{console.error("Error leyendo archivo:",e),x.default.fire("Error","No se pudo leer el archivo","error")})}onFileTableAction(e){if(!e||!e.action_to_perform)return;let t=e.data;switch(e.action_to_perform){case"edit_file":this.editFile(t);break;case"delete_file":this.deleteFile(t);break;default:}}editFile(e){e&&x.default.fire({title:"Editar Archivo",html:`
      <div class="mb-3">
        <label class="form-label">Archivo (opcional, para reemplazar)</label>
        <input id="swal-input-file" type="file" class="form-control" />
      </div>
      <div class="mb-3">
        <label class="form-label">Versi\xF3n</label>
        <input id="swal-input-version" class="form-control" value="${e.version||""}" placeholder="1.0">
      </div>
      <div class="mb-3">
        <label class="form-label">T\xEDtulo</label>
        <input id="swal-input-title" class="form-control" value="${e.title||""}" placeholder="Contratos v1">
      </div>
    `,showCancelButton:!0,confirmButtonText:"Guardar cambios",cancelButtonText:"Cancelar",confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545",focusConfirm:!1,preConfirm:()=>{let t=document.getElementById("swal-input-file"),i=document.getElementById("swal-input-version"),r=document.getElementById("swal-input-title"),a=(i?.value||"").trim(),n=(r?.value||"").trim(),l=t?.files&&t.files.length>0?t.files[0]:null;return!a||!n?(x.default.showValidationMessage("Versi\xF3n y T\xEDtulo son requeridos"),!1):{newFile:l,version:a,title:n}}}).then(t=>{if(!t.isConfirmed||!t.value)return;let{newFile:i,version:r,title:a}=t.value,n=(e.path||e.id||"").toString();if(!n){x.default.fire("Error","Ruta del archivo inv\xE1lida.","error");return}if(!i){this.OymService.EditarArchivoMPPs(n,n,{name:e.name,title:a,version:r}).subscribe({next:p=>{p&&p.success?(x.default.fire("\xA1\xC9xito!","Metadatos actualizados correctamente","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)):x.default.fire("Error",p?.message||"No se pudo actualizar el archivo","error")},error:p=>{console.error(p);let h=p?.error?.message||"Error al actualizar archivo";x.default.fire("Error",h,"error")}});return}let A={name:(i.name||"file").replace(/\.[^/.]+$/,""),title:a,version:r},F=n.lastIndexOf("/"),S=F>=0?n.substring(0,F):this.selectedFolder||"";this.OymService.GuardarArchivoMPPs(i,S,A).subscribe({next:p=>{if(!p||!p.success){x.default.fire("Error",p?.message||"No se pudo guardar el nuevo archivo","error");return}this.OymService.EliminarArchivoMPPs(n).subscribe({next:h=>{!h||!h.success?x.default.fire("Advertencia","Nuevo archivo guardado, pero no se pudo eliminar el anterior.","warning"):x.default.fire("\xA1\xC9xito!","Archivo actualizado correctamente","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)},error:h=>{console.error(h),x.default.fire("Advertencia","Nuevo archivo guardado, pero ocurri\xF3 un error al eliminar el anterior.","warning"),this.selectedFolder&&this.selectFolder(this.selectedFolder)}})},error:p=>{console.error(p);let h=p?.error?.message||"Error al subir el nuevo archivo";x.default.fire("Error",h,"error")}})})}deleteFile(e){e&&this.selectedFolder&&x.default.fire({title:"\xBFEliminar archivo?",html:`
        <div class="text-start">
          <p>\xBFEst\xE1s seguro de eliminar el siguiente archivo?</p>
          <ul class="list-unstyled">
            <li><strong>Nombre:</strong> ${e.name}</li>
            <li><strong>Versi\xF3n:</strong> ${e.version}</li>
            <li><strong>T\xEDtulo:</strong> ${e.title}</li>
          </ul>
          <p class="text-danger">Esta acci\xF3n no se puede deshacer.</p>
        </div>
      `,icon:"warning",showCancelButton:!0,confirmButtonText:"S\xED, eliminar",cancelButtonText:"Cancelar",confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d"}).then(t=>{if(t.isConfirmed){let i=e.path||e.id||e.name;this.OymService.EliminarArchivoMPPs(i).subscribe({next:r=>{r&&r.success?(x.default.fire("\xA1Eliminado!","El archivo ha sido eliminado.","success"),this.selectedFolder&&this.selectFolder(this.selectedFolder)):x.default.fire("Error",r&&r.message?r.message:"No se pudo eliminar archivo","error")},error:r=>{console.error(r),x.default.fire("Error","Error al eliminar archivo","error")}})}})}getIconForExt(e){let t=(e||"").toLowerCase(),i=r=>r.includes(t);return i(["pdf"])?{cls:"fa-solid fa-file-pdf text-danger",label:"PDF"}:i(["doc","docx","rtf"])?{cls:"fa-solid fa-file-word text-primary",label:"Word"}:i(["xls","xlsx","csv"])?{cls:"fa-solid fa-file-excel text-success",label:"Excel"}:i(["ppt","pptx"])?{cls:"fa-solid fa-file-powerpoint text-warning",label:"PowerPoint"}:i(["jpg","jpeg","png","gif","bmp","webp","tiff","svg"])?{cls:"fa-solid fa-file-image text-info",label:"Imagen"}:i(["txt","md","log"])?{cls:"fa-solid fa-file-lines",label:"Texto"}:i(["zip","rar","7z"])?{cls:"fa-solid fa-file-zipper",label:"Comprimido"}:i(["json","xml","yml","yaml"])?{cls:"fa-solid fa-file-code",label:"C\xF3digo"}:{cls:"fa-solid fa-file",label:"Archivo"}}static \u0275fac=function(t){return new(t||o)(I(k),I(L),I(q))};static \u0275cmp=O({type:o,selectors:[["app-contratos"]],decls:16,vars:10,consts:[[1,"container-fluid","customer-order-wrapper"],[1,"row"],[1,"col-12"],[3,"headerTitle","cardClass"],["class","row mb-3",4,"ngIf"],[1,"col-md-6","mb-2"],["class","btn btn-outline-secondary",3,"click",4,"ngIf"],[1,"customer-order-report","table-responsive","custom-scrollbar"],["class","col-md-4",4,"ngIf"],[3,"ngClass"],[1,"mb-3"],[4,"ngIf"],["class","p-3 text-muted",4,"ngIf"],[1,"row","mb-3"],[1,"input-group"],["type","text","placeholder","Nombre de la nueva carpeta",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-append","ms-4"],["type","button",1,"btn","btn-primary",3,"click"],[1,"btn","btn-outline-secondary",3,"click"],[1,"col-md-4"],["class","p-3",4,"ngIf"],["class","list-group",4,"ngIf"],[1,"p-3"],[1,"list-group"],["class","list-group-item d-flex align-items-center","style","cursor:pointer;",3,"active","click",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","align-items-center",2,"cursor","pointer",3,"click"],[1,"flex-grow-1","text-truncate",3,"title"],[1,"fa","fa-folder","me-2"],[1,"text-muted","small"],["type","button",1,"btn","btn-sm","p-0",3,"click"],[1,"fa","fa-trash"],[1,"text-primary"],[1,"p-3","text-muted"],[3,"action","customAction","hasCheckbox","tableConfig","pageSize","paginateDetails","selectedRows","downloadReports","customButtons"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-card",3),y(4,qe,7,1,"div",4),s(5,"div",5),y(6,Je,2,0,"button",6),d(),s(7,"div",7)(8,"div",1),y(9,Ye,6,2,"div",8),s(10,"div",9)(11,"div",10),y(12,Ze,2,0,"h6",11)(13,et,4,1,"h6",11)(14,tt,2,0,"div",12)(15,it,2,7,"div",11),d()()()()()()()()),t&2&&(c(3),m("headerTitle","")("cardClass","mb-4"),c(),m("ngIf",i.canCreateFolder),c(2),m("ngIf",i.isAdmin&&!i.showFoldersPanel),c(3),m("ngIf",i.showFoldersPanel),c(),m("ngClass",i.showFoldersPanel?"col-md-8":"col-md-12"),c(2),m("ngIf",!i.selectedFolder),c(),m("ngIf",i.selectedFolder),c(),m("ngIf",!i.selectedFolder),c(),m("ngIf",i.selectedFolder))},dependencies:[G,j,W,U,X,J,K,Q,Y,Z],encapsulation:2})};var Rt=[{path:"mpps/manuales_de_funciones",component:oe,data:{title:"Manual de Funciones",breadcrumb:"Manual de Funciones"}},{path:"mpps/procedimientos",component:ne,data:{title:"Procedimientos",breadcrumb:"Procedimientos"}},{path:"mpps/politicas",component:ae,data:{title:"Pol\xEDticas",breadcrumb:"Pol\xEDticas"}},{path:"mpps/contratos",component:le,data:{title:"Contratos",breadcrumb:"Contratos"}}];export{Rt as oymRoutes};
