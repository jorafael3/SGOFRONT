import{c as H,d as mt,e as ut,f as Ct,g as bt,m as gt,v as ft,x as ht}from"./chunk-AMGMCQ56.js";import{a as St}from"./chunk-AI45PTO7.js";import{A as ct,H as _t,I as dt,N as pt,q as lt,t as rt,v as st}from"./chunk-LVDJUO5Z.js";import{k as I,n as at,r as O,t as R}from"./chunk-AQUAFEI7.js";import{$ as Y,Ab as x,Bb as $,Cb as q,Db as d,Fb as v,Gb as y,Hb as w,Ib as s,Jb as c,Kb as k,Ob as g,Ub as p,Vb as a,Xa as L,Yb as W,ab as l,bc as X,cc as _,dc as S,e as vt,ec as T,fc as K,gb as P,gc as Q,hc as G,ic as J,jc as Z,kc as tt,lb as M,ma as U,mc as D,na as m,oa as u,qb as C,qc as et,sc as it,uc as nt,wa as V,wb as B,yb as b,yc as ot}from"./chunk-FF5Z5KFO.js";var wt=vt(St());var A=i=>({disabled:i}),Ft=i=>({active:i});function Vt(i,e){if(i&1&&(s(0,"p"),_(1),c()),i&2){let t=a();l(),Q("Showing ",t.paginate.total_items>0?t.paginate.start_index+1:0,"- ",t.paginate.total_items>0?t.paginate.end_index+1:0," of ",t.paginate.total_items>0?t.paginate.total_items:0," entries ")}}function Pt(i,e){if(i&1&&(s(0,"span",2)(1,"span",6),_(2),c()()),i&2){let t=a();l(2),T(" ",t.selectedItems," rows selected ")}}function Et(i,e){if(i&1){let t=g();s(0,"li",4)(1,"a",5),p("click",function(){let n=m(t).$implicit,r=a();return u(r.pageSet(n))}),_(2),c()()}if(i&2){let t=e.$implicit,o=a();b("ngClass",D(2,Ft,o.paginate.current_page==t)),l(2),S(t)}}var j=class i{total;currentPage;pageSize;paginate={};paginateDetails;selectedItems;selectedRows;setPage=new V;pageSet(e){this.setPage.emit(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=M({type:i,selectors:[["app-pagination"]],inputs:{total:"total",currentPage:"currentPage",pageSize:"pageSize",paginate:"paginate",paginateDetails:"paginateDetails",selectedItems:"selectedItems",selectedRows:"selectedRows"},outputs:{setPage:"setPage"},decls:19,vars:14,consts:[[1,"bottom-info"],[1,"d-flex","cb-info"],[1,"select-info"],[1,"pagination","justify-content-center"],[1,"page-item",3,"ngClass"],["href","javascript:void(0)",1,"page-link",3,"click"],[1,"select-item"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"div",1),C(2,Vt,2,3,"p")(3,Pt,3,1,"span",2),c(),s(4,"ul",3)(5,"li",4)(6,"a",5),p("click",function(){return o.pageSet(1)}),_(7," \xAB "),c()(),s(8,"li",4)(9,"a",5),p("click",function(){return o.pageSet(o.paginate.current_page-1)}),_(10," \u2039 "),c()(),y(11,Et,3,4,"li",4,v),s(13,"li",4)(14,"a",5),p("click",function(){return o.pageSet(o.paginate.current_page+1)}),_(15," \u203A "),c()(),s(16,"li",4)(17,"a",5),p("click",function(){return o.pageSet(o.paginate.end_page)}),_(18," \xBB "),c()()()()),t&2&&(l(2),d(o.paginateDetails?2:-1),l(),d(o.selectedItems&&o.selectedRows?3:-1),l(2),b("ngClass",D(6,A,o.paginate.current_page===1)),l(3),b("ngClass",D(8,A,o.paginate.current_page===1)),l(3),w(o.paginate.pages),l(2),b("ngClass",D(10,A,o.paginate.current_page==o.paginate.total_pages)),l(3),b("ngClass",D(12,A,o.paginate.current_page==o.paginate.total_pages)))},dependencies:[R,I],encapsulation:2})};var z=class i{searchText="";getPager(e,t,o){let n=Number(Math.ceil(Number(e)/Number(o))),r=3;Number(t)<1?t=1:Number(t)>Number(n)&&(t=Number(n));let f,h;Number(n)<=Number(r)?(f=1,h=Number(n)):Number(t)<=Number(Math.floor(Number(r)/2))?(f=1,h=Number(r)):Number(t)>=Number(n)-Number(Math.floor(Number(r)/2))?(f=Number(n)-Number(r)+1,h=Number(n)):(f=Number(t)-Number(Math.floor(Number(r)/2)),h=Number(t)+Number(Math.floor(Number(r)/2)));let E=(Number(t)-1)*Number(o),F=Math.min(Number(E)+Number(o)-1,Number(e)-1),N=Array.from(Array(Number(h)+1-Number(f)).keys()).map(Tt=>Number(f)+Number(Tt));return{total_items:e,current_page:t,page_size:o,total_pages:n,start_page:f,end_page:h,start_index:E,end_index:F,pages:N}}static \u0275fac=function(t){return new(t||i)};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})};var Mt=i=>({background:i,cursor:"pointer"}),Bt=(i,e)=>e.action,$t=(i,e)=>e.value;function It(i,e){if(i&1&&(s(0,"option",10),_(1),c()),i&2){let t=e.$implicit;b("value",t.value)("selected",t.selected),l(),S(t.title)}}function Ot(i,e){if(i&1){let t=g();s(0,"select",9),p("change",function(n){m(t);let r=a(3);return u(r.handleSelect(n))}),y(1,It,2,3,"option",10,v),c()}if(i&2){let t=a(3);l(),w(t.pageSizeOptions)}}function Rt(i,e){if(i&1){let t=g();s(0,"span",18),p("mouseenter",function(){let n=m(t).$implicit,r=a(5);return u(r.hoveredDate=n)})("mouseleave",function(){m(t);let n=a(5);return u(n.hoveredDate=null)}),_(1),c()}if(i&2){let t=e.$implicit,o=e.focused,n=a(5);x("focused",o)("range",n.isRange(t))("faded",n.isHovered(t)||n.isInside(t)),l(),T(" ",t.day," ")}}function At(i,e){if(i&1){let t=g();s(0,"ngb-datepicker",17,0),p("dateSelect",function(n){m(t);let r=a(4);return u(r.onDateSelection(n))}),c(),C(2,Rt,2,7,"ng-template",null,1,nt)}if(i&2){let t=X(3);b("displayMonths",2)("dayTemplate",t)}}function jt(i,e){if(i&1){let t=g();s(0,"div")(1,"div",11)(2,"div",12)(3,"label",13),_(4,"Seleccione fechas"),c()(),s(5,"div",12)(6,"div",14)(7,"span",15),p("click",function(){m(t);let n=a(3);return u(n.handleDropdown())}),_(8),c(),s(9,"div",16)(10,"button",15),p("click",function(){m(t);let n=a(3);return u(n.handleDateFilter("today"))}),_(11,"Hoy"),c(),s(12,"button",15),p("click",function(){m(t);let n=a(3);return u(n.handleDateFilter("yesterday"))}),_(13,"Ayer"),c(),s(14,"button",15),p("click",function(){m(t);let n=a(3);return u(n.handleDateFilter("7_days"))}),_(15,"\xDAltimos 7 d\xEDas"),c(),s(16,"button",15),p("click",function(){m(t);let n=a(3);return u(n.handleDateFilter("30_days"))}),_(17,"\xDAltimos 30 d\xEDas"),c(),s(18,"button",15),p("click",function(){m(t);let n=a(3);return u(n.handleDateFilter("this_month"))}),_(19,"Este mes"),c(),s(20,"button",15),p("click",function(){m(t);let n=a(3);return u(n.handleDateFilter("last_month"))}),_(21,"\xDAltimo mes"),c(),s(22,"button",15),p("click",function(){m(t);let n=a(3);return u(n.handleDateFilter("custom"))}),_(23,"Rango personalizado"),c()()(),C(24,At,4,2),c()()()}if(i&2){let t=a(3);l(8),S(t.selectedDate?t.selectedDate:"Seleccionar"),l(),x("range-option",t.dateDropdownOpen),l(),x("active",t.selectedValue=="today"),l(2),x("active",t.selectedValue=="yesterday"),l(2),x("active",t.selectedValue=="7_days"),l(2),x("active",t.selectedValue=="30_days"),l(2),x("active",t.selectedValue=="this_month"),l(2),x("active",t.selectedValue=="last_month"),l(2),x("active",t.selectedValue=="custom"),l(2),d(t.selectedValue==="custom"?24:-1)}}function zt(i,e){if(i&1){let t=g();s(0,"div",8)(1,"label"),_(2,"Search: "),s(3,"input",19),Z("ngModelChange",function(n){m(t);let r=a(3);return J(r.searchText,n)||(r.searchText=n),u(n)}),p("keyup",function(){m(t);let n=a(3);return u(n.searchTerm(n.searchText))}),c()()()}if(i&2){let t=a(3);l(3),G("ngModel",t.searchText),b("placeholder",t.searchPlaceholder)}}function Lt(i,e){if(i&1&&(s(0,"div",2),C(1,Ot,3,0,"select")(2,jt,25,18,"div")(3,zt,4,2,"div",8),c()),i&2){let t=a(2);l(),d(t.showPaginate?1:-1),l(),d(t.dateFilter?2:-1),l(),d(t.search?3:-1)}}function Ht(i,e){if(i&1&&k(0,"i"),i&2){let t=a().$implicit;$(t.icon)}}function Yt(i,e){if(i&1){let t=g();s(0,"button",23),p("click",function(){let n=m(t).$implicit,r=a(3);return u(r.handleCustomAction(n.action))}),C(1,Ht,1,2,"i",24),s(2,"span"),_(3),c()()}if(i&2){let t=e.$implicit;$(t.class||"btn btn-outline-secondary"),b("title",t.tooltip||t.label),l(),d(t.icon?1:-1),l(2),S(t.label)}}function Ut(i,e){i&1&&k(0,"div",22)}function qt(i,e){if(i&1){let t=g();s(0,"button",30),p("click",function(){m(t);let n=a(4);return u(n.exportData("copy"))}),s(1,"span"),_(2,"Copy"),c()()}}function Wt(i,e){if(i&1){let t=g();s(0,"button",31),p("click",function(){m(t);let n=a(4);return u(n.exportData("csv"))}),s(1,"span"),_(2,"CSV"),c()()}}function Xt(i,e){if(i&1){let t=g();s(0,"button",32),p("click",function(){m(t);let n=a(4);return u(n.exportData("excel"))}),s(1,"span"),_(2,"Excel"),c()()}}function Kt(i,e){if(i&1){let t=g();s(0,"button",33),p("click",function(){m(t);let n=a(4);return u(n.exportData("pdf"))}),s(1,"span"),_(2,"PDF"),c()()}}function Qt(i,e){if(i&1){let t=g();s(0,"button",34),p("click",function(){m(t);let n=a(4);return u(n.exportData("print"))}),s(1,"span"),_(2,"Print"),c()()}}function Gt(i,e){if(i&1&&C(0,qt,3,0,"button",25)(1,Wt,3,0,"button",26)(2,Xt,3,0,"button",27)(3,Kt,3,0,"button",28)(4,Qt,3,0,"button",29),i&2){let t=a(3);d(t.shouldShowButton("copy")?0:-1),l(),d(t.shouldShowButton("csv")?1:-1),l(),d(t.shouldShowButton("excel")?2:-1),l(),d(t.shouldShowButton("pdf")?3:-1),l(),d(t.shouldShowButton("print")?4:-1)}}function Jt(i,e){if(i&1&&(s(0,"div",3)(1,"div",20),y(2,Yt,4,5,"button",21,Bt),C(4,Ut,1,0,"div",22)(5,Gt,5,5),c()()),i&2){let t=a(2);l(2),w(t.customButtons),l(2),d(t.customButtons.length>0&&t.downloadReports?4:-1),l(),d(t.downloadReports?5:-1)}}function Zt(i,e){if(i&1){let t=g();s(0,"th",35)(1,"input",36),p("change",function(n){m(t);let r=a(2);return u(r.checkUncheckAll(n))}),c()()}if(i&2){let t=a(2);x("selected-checkbox",t.selected.length&&t.selected.length!=t.tableConfig.data.length),l(),b("checked",t.tableConfig&&t.tableConfig.data.length&&t.selected&&t.selected.length==t.tableConfig.data.length||!1)}}function te(i,e){i&1&&k(0,"th")}function ee(i,e){if(i&1){let t=g();s(0,"th",38),p("click",function(){m(t);let n=a(2).$implicit,r=a(2);return u(r.onSort(n.sortable_key?n.sortable_key:n.field_value))}),_(1),k(2,"span",39),c()}if(i&2){let t=a(2).$implicit,o=a(2);b("ngClass",o.sortable_key==(t.sortable_key?t.sortable_key:t.field_value)&&o.filter.sort=="asc"?"asc":o.sortable_key==(t.sortable_key?t.sortable_key:t.field_value)&&o.filter.sort=="desc"?"desc":""),l(),T(" ",t.title," ")}}function ie(i,e){if(i&1&&(s(0,"th"),_(1),c()),i&2){let t=a(2).$implicit;l(),T(" ",t.title," ")}}function ne(i,e){if(i&1&&C(0,ee,3,2,"th",37)(1,ie,2,1,"th"),i&2){let t=a().$implicit;d(t.sort?0:1)}}function oe(i,e){if(i&1&&C(0,ne,2,1),i&2){let t=e.$implicit;d(t.hide_column?-1:0)}}function ae(i,e){i&1&&(s(0,"th"),_(1),c()),i&2&&(l(),S("Acciones"))}function le(i,e){if(i&1){let t=g();s(0,"td",35)(1,"input",42),p("change",function(n){m(t);let r=a(4);return u(r.onItemChecked(n))}),c()()}if(i&2){let t=a().$implicit,o=a(3);l(),b("value",t==null?null:t.id)("checked",o.selected&&o.selected.length&&o.selected.includes(t.id)),B("data-id",t.id)}}function re(i,e){if(i&1){let t=g();s(0,"td",43),p("click",function(){m(t);let n=a().$implicit,r=a(3);return u(r.openRowDetails(n.id))}),c()}if(i&2){let t=a().$implicit,o=a(3);b("ngStyle",D(1,Mt,"url(assets/images/"+(o.selectedOpenRows.includes(t.id)?"details_close":"details_open")+".png) no-repeat center center"))}}function se(i,e){if(i&1&&(s(0,"td"),_(1),c()),i&2){let t=a(2).$implicit,o=a().$implicit;l(),K(" ",o[t.field_value]," ",t.type=="qty"?t.text?t.text:"QTY":t.type=="purchase"?"Purchases":""," ")}}function ce(i,e){if(i&1&&(_(0),et(1,"number")),i&2){let t=a(3).$implicit,o=a().$implicit;T(" $",it(1,1,o[t.field_value],"1.2-2")," ")}}function _e(i,e){if(i&1&&_(0),i&2){let t=a(3).$implicit,o=a().$implicit;T(" $",o[t.field_value]," ")}}function de(i,e){if(i&1&&(s(0,"td",37),C(1,ce,2,4)(2,_e,1,1),c()),i&2){let t=a(2).$implicit;b("ngClass",t.class?t.class:""),l(),d(t.decimal_number?1:2)}}function pe(i,e){if(i&1&&(s(0,"option",10),_(1),c()),i&2){let t=e.$implicit,o=a(3).$implicit,n=a().$implicit;b("value",t.value)("selected",n[o.field_value]===t.value),l(),T(" ",t.label," ")}}function me(i,e){if(i&1){let t=g();s(0,"td")(1,"select",45),p("change",function(n){m(t);let r=a(2).$implicit,f=a().$implicit,h=a(3);return u(h.onSelectChange(n,r,f))}),y(2,pe,2,3,"option",10,$t),c()()}if(i&2){let t=a(2).$implicit,o=a().$implicit;l(),b("value",o[t.field_value]||""),l(),w(t.options)}}function ue(i,e){if(i&1&&_(0),i&2){let t=a(3).$implicit;T(" ",t.text," ")}}function Ce(i,e){if(i&1&&(s(0,"td",44),C(1,ue,1,1),c()),i&2){let t=a(2).$implicit,o=a().$implicit;b("innerHTML",o[t.field_value],L),l(),d(t.text?1:-1)}}function be(i,e){if(i&1&&C(0,se,2,2,"td")(1,de,3,2,"td",37)(2,me,4,1,"td")(3,Ce,2,2,"td",44),i&2){let t=a().$implicit;d(t.type=="qty"||t.type=="purchase"?0:t.type=="price"?1:t.type=="select"?2:3)}}function ge(i,e){if(i&1&&C(0,be,4,1),i&2){let t=e.$implicit;d(t.hide_column?-1:0)}}function fe(i,e){if(i&1&&(k(0,"i"),_(1," \xA0 ")),i&2){let t=a().$implicit;q("fa-solid fa-",t.icon,"")}}function he(i,e){if(i&1&&(s(0,"span"),_(1),c()),i&2){let t=a().$implicit;l(),S(t.label)}}function xe(i,e){if(i&1){let t=g();s(0,"button",48),p("click",function(){let n=m(t).$implicit,r=a(2).$implicit,f=a(3);return u(f.handleAction(n,r))}),s(1,"span"),C(2,fe,2,3)(3,he,2,1,"span"),c()()}if(i&2){let t=e.$implicit;$(t.class),W("title",t.tooltip),l(2),d(t.icon?2:-1),l(),d(t.label?3:-1)}}function ye(i,e){if(i&1&&(s(0,"td")(1,"div",46),y(2,xe,4,5,"button",47,v),c()()),i&2){let t=a(4);l(2),w(t.tableConfig.row_action)}}function we(i,e){if(i&1&&(s(0,"tr")(1,"td"),_(2),c(),k(3,"td",44),c()),i&2){let t=e.$implicit,o=a(2).$implicit;l(2),S(t.title),l(),b("innerHTML",o[t.field_value],L)}}function Te(i,e){if(i&1&&(s(0,"tr",41)(1,"td",49)(2,"table",50)(3,"tbody"),y(4,we,4,2,"tr",null,v),c()()()()),i&2){let t=a(4);l(4),w(t.tableConfig.columns)}}function ve(i,e){if(i&1&&(s(0,"tr"),C(1,le,2,3,"td",35)(2,re,1,3,"td",40),y(3,ge,1,1,null,null,v),C(5,ye,4,0,"td"),c(),C(6,Te,6,0,"tr",41)),i&2){let t=e.$implicit,o=a(3);x("selected",o.selected&&o.selected.length&&o.selected.includes(t.id)),l(),d(o.hasCheckbox?1:-1),l(),d(o.rowDetails?2:-1),l(),w(o.tableConfig.columns),l(2),d(o.tableConfig.row_action?5:-1),l(),d(o.rowDetails&&o.selectedOpenRows.includes(t.id)?6:-1)}}function Se(i,e){if(i&1&&(s(0,"tbody"),y(1,ve,7,6,null,null,v),c()),i&2){let t=a(2);l(),w(t.tableData)}}function De(i,e){if(i&1&&(s(0,"tbody")(1,"tr")(2,"td",51),_(3,"No hay datos disponibles"),c()()()),i&2){let t=a(2);l(),B("data-dt-row",t.getColSpan()),l(),B("colspan",t.getColSpan())}}function ke(i,e){if(i&1){let t=g();s(0,"app-pagination",52),p("setPage",function(n){m(t);let r=a(2);return u(r.setPage(n))}),c()}if(i&2){let t=a(2);b("total",t.tableConfig.data.length)("paginate",t.paginate)("paginateDetails",t.paginateDetails)("selectedRows",t.selectedRows)("selectedItems",t.selected.length)}}function Fe(i,e){if(i&1&&(C(0,Lt,4,3,"div",2)(1,Jt,6,2,"div",3),s(2,"table",4)(3,"thead",5)(4,"tr"),C(5,Zt,2,3,"th",6)(6,te,1,0,"th"),y(7,oe,1,1,null,null,v),C(9,ae,2,1,"th"),c()(),C(10,Se,3,0,"tbody")(11,De,4,2,"tbody"),c(),C(12,ke,1,5,"app-pagination",7)),i&2){let t=a();d(t.search||t.dateFilter||t.showPaginate?0:-1),l(),d(t.downloadReports||t.customButtons.length>0?1:-1),l(),b("ngClass",t.tableClass),l(3),d(t.hasCheckbox?5:-1),l(),d(t.rowDetails?6:-1),l(),w(t.tableConfig.columns),l(2),d(t.tableConfig.row_action?9:-1),l(),d(t.tableData&&t.tableData.length?10:t.tableData.length?-1:11),l(2),d(t.tableConfig.data.length&&t.pagination?12:-1)}}var yt=class i{constructor(e,t,o,n,r){this.tableService=e;this.modal=t;this.calendar=o;this.formatter=n;this.cdr=r}selectValues={};tableConfig;hasCheckbox;pageSize=4;paginateDetails=!1;showPaginate=!1;tableClass;search=!0;pagination=!0;selectedRows=!1;rowDetails=!1;dateFilter=!1;initialDateFilter="";downloadReports=!1;searchPlaceholder="";showCopyButton=!0;showCsvButton=!0;showExcelButton=!0;showPdfButton=!0;showPrintButton=!0;exportButtons=[];customButtons=[];action=new V;customAction=new V;dateFilterChange=new V;tableData$;total$;selected=[];paginate;tableData;pageNo=1;sortValue="asc";sortable_key;searchText="";rowDetailOpen=!1;selectedOpenRows=[];dateDropdownOpen=!1;hoveredDate=null;fromDate;toDate;filter={search:"",sort:"asc",page:this.pageNo,pageSize:this.pageSize,date:{start_date:"",to_date:""}};pageSizeOptions=[{title:10,value:10},{title:15,value:15},{title:25,value:25},{title:50,value:50},{title:100,value:100}];selectedDate="";selectedValue="";shouldShowButton(e){if(this.exportButtons&&this.exportButtons.length>0)return this.exportButtons.includes(e);switch(e){case"copy":return this.showCopyButton;case"csv":return this.showCsvButton;case"excel":return this.showExcelButton;case"pdf":return this.showPdfButton;case"print":return this.showPrintButton;default:return!0}}handleCustomAction(e){this.customAction.emit({action:e,data:this.tableConfig.data})}ngOnChanges(e){if(e.pageSize&&(this.filter.pageSize=e.pageSize.currentValue,!this.pageSizeOptions.some(t=>t.value===this.filter.pageSize))){let t=this.pageSizeOptions.findIndex(n=>n.value>this.filter.pageSize),o={title:this.filter.pageSize,value:this.filter.pageSize,selected:!0};t===-1?this.pageSizeOptions.push(o):this.pageSizeOptions.splice(t,0,o)}e.initialDateFilter&&e.initialDateFilter.currentValue&&(this.selectedValue=e.initialDateFilter.currentValue,this.handleDateFilter(this.selectedValue)),e.tableConfig&&this.tableConfig&&this.tableConfig.data&&(this.paginateData(),this.cdr.detectChanges()),e.pageNo&&this.paginateData()}isArray(e){return Array.isArray(e)}getNestedPropertyValue(e,t){if(!e)return"";let o=e.split("."),n=t;for(let r of o)if(n&&n.hasOwnProperty(r))n=n[r];else return"";return n}getColumnClass(e,t){for(let o in t)if(e.includes(o)){let n=t[o];e=e.replace(o,n)}return e}checkUncheckAll(e){this.tableConfig.data.forEach(t=>{t.is_checked=e?.target?.checked,this.setSelectedItem(e?.target?.checked,t?.id)})}onItemChecked(e){this.setSelectedItem(e.target?.checked,Number(e.target?.value))}setSelectedItem(e,t){let o=this.selected.indexOf(Number(t));e?o==-1&&this.selected.push(Number(t)):this.selected=this.selected.filter(n=>n!==Number(t))}onSort(e){this.sortable_key=e,this.filter.page=1,this.filter.sort=="asc"?this.filter.sort="desc":this.filter.sort="asc",this.applyFilters()}paginateData(){this.tableConfig&&this.tableConfig.data&&this.applyFilters()}setPage(e){this.filter.page=e,this.paginateData()}searchTerm(e){this.filter.page=1,this.filter.search=e,this.applyFilters()}handleSelect(e){this.filter.pageSize=+e.target.value,this.applyFilters()}handleAction(e,t){e.action_to_perform=="delete"?e.modal?wt.default.fire({title:"Are you sure?",text:e.model_text?e.model_text:"Do you really want to delete the product?",imageUrl:"assets/images/gif/trash.gif",confirmButtonText:"Yes, delete it!",showCancelButton:!0,cancelButtonText:"Cancel",cancelButtonColor:"#FC4438"}).then(o=>{o.isConfirmed&&this.action.emit({action_to_perform:e.action_to_perform,data:t})}):this.action.emit({action_to_perform:e.action_to_perform,data:t}):this.action.emit({action_to_perform:e.action_to_perform,data:t})}openRowDetails(e){this.selectedOpenRows.indexOf(e)===-1?this.selectedOpenRows.push(e):this.selectedOpenRows=this.selectedOpenRows.filter(o=>o!==e)}getColSpan(){let e=this.tableConfig.columns.length,t=this.tableConfig.row_action?1:0,o=this.hasCheckbox?1:0,n=this.rowDetails?1:0;return e+t+o+n}handleDropdown(){this.dateDropdownOpen=!this.dateDropdownOpen}handleDateFilter(e){this.selectedValue=e;let t=new Date,o=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0");if(this.selectedValue){if(this.selectedValue==="today")this.filter.date.start_date=o,this.filter.date.to_date=o;else if(this.selectedValue==="yesterday"){let n=new Date(t);n.setDate(t.getDate()-1),o=n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0"),this.filter.date.start_date=o,this.filter.date.to_date=o}else if(this.selectedValue==="7_days"){let n=new Date(t);n.setDate(t.getDate()-7),o=n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0"),this.filter.date.start_date=o,this.filter.date.to_date=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0")}else if(this.selectedValue==="30_days"){let n=new Date(t);n.setDate(t.getDate()-30),o=n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0"),this.filter.date.start_date=o,this.filter.date.to_date=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0")}else if(this.selectedValue==="this_month"){let n=new Date(t.getFullYear(),t.getMonth(),1),r=n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0"),f=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0");this.filter.date.start_date=r,this.filter.date.to_date=f}else if(this.selectedValue==="last_month"){let n=new Date(t.getFullYear(),t.getMonth()-1,1),r=new Date(t.getFullYear(),t.getMonth(),0);o=n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0"),this.filter.date.start_date=o,o=r.getFullYear()+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0"),this.filter.date.to_date=o}}this.selectedDate=`${this.filter.date.start_date} - ${this.filter.date.to_date}`,this.dateDropdownOpen=!1,this.applyFilters(),console.log("Rango de fechas seleccionado:",this.selectedDate),this.dateFilterChange.emit(this.selectedValue)}onDateSelection(e){!this.fromDate||this.fromDate&&this.toDate?(this.fromDate=e,this.toDate=null):this.fromDate&&!this.toDate&&(e.after(this.fromDate)?(this.toDate=e,this.filter.date.start_date=`${this.fromDate.year}-${String(this.fromDate.month).padStart(2,"0")}-${String(this.fromDate.day).padStart(2,"0")}`,this.filter.date.to_date=`${this.toDate.year}-${String(this.toDate.month).padStart(2,"0")}-${String(this.toDate.day).padStart(2,"0")}`,this.selectedDate=`${this.filter.date.start_date} - ${this.filter.date.to_date}`):this.fromDate=e),this.fromDate&&this.toDate&&(this.selectedValue=""),this.applyFilters()}isHovered(e){return this.fromDate&&!this.toDate&&this.hoveredDate&&e.after(this.fromDate)&&e.before(this.hoveredDate)}isInside(e){return this.toDate&&e.after(this.fromDate)&&e.before(this.toDate)}isRange(e){return e.equals(this.fromDate)||this.toDate&&e.equals(this.toDate)||this.isInside(e)||this.isHovered(e)}validateInput(e,t){let o=this.formatter.parse(t);return o&&this.calendar.isValid(H.from(o))?H.from(o):e}applyFilters(){let e=[...this.tableConfig.data];this.filter.search.trim()!==""&&(e=e.filter(t=>Object.keys(t).some(o=>{let n=t[o];return!!((typeof n=="string"||typeof n=="object")&&(typeof n=="string"?n:n.toString()).toLowerCase().includes(this.filter.search.toLowerCase())||typeof n=="number"&&n.toString().includes(this.filter.search))}))),this.filter.sort&&e.sort((t,o)=>{let n=t[this.sortable_key],r=o[this.sortable_key],f=F=>{if(typeof F=="string")return F;if(typeof F=="object"){let N=document.createElement("div");return N.innerHTML=F.toString(),N.textContent||N.innerText||""}return""},h=f(n),E=f(r);return(typeof n=="string"||typeof n=="object")&&(typeof r=="string"||typeof r=="object")?this.filter.sort==="asc"?h.localeCompare(E):E.localeCompare(h):typeof n=="number"&&typeof r=="number"?this.filter.sort==="asc"?n-r:r-n:0}),this.filter.date.start_date&&(e=e.filter(t=>{if(t&&t.date){let o=new Date(t.date),n=new Date(this.filter.date.start_date),r=this.filter.date.to_date?new Date(this.filter.date.to_date):null;if(n&&r)return o>=n&&o<=r;if(n)return o>=n;if(r)return o<=r}return!0})),this.paginate=this.tableService.getPager(e.length,this.filter.page,this.filter.pageSize),this.tableData=e.slice(this.paginate.start_index,this.paginate.end_index+1)}exportData(e){let t=this.getExportData();switch(e){case"copy":this.copyToClipboard(t);break;case"csv":this.exportToCSV(t);break;case"excel":this.exportToExcel(t);break;case"pdf":this.exportToPDF(t);break;case"print":this.printData(t);break}}getExportData(){let e=this.tableConfig.columns.filter(o=>!o.hide_column).map(o=>o.title),t=this.tableConfig.data.map(o=>this.tableConfig.columns.filter(n=>!n.hide_column).map(n=>{let r=o[n.field_value];return typeof r=="string"&&(r=r.replace(/<[^>]*>/g,"").trim()),r||""}));return{headers:e,rows:t}}copyToClipboard(e){let t=[e.headers,...e.rows].map(o=>o.join("	")).join(`
`);navigator.clipboard.writeText(t).then(()=>{alert("Datos copiados al portapapeles")})}exportToCSV(e){let t=[e.headers,...e.rows].map(f=>f.map(h=>`"${h}"`).join(",")).join(`
`),o=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),r=URL.createObjectURL(o);n.setAttribute("href",r),n.setAttribute("download","export.csv"),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}exportToExcel(e){try{let t=window.XLSX;if(t){let o=t.utils.aoa_to_sheet([e.headers,...e.rows]),n=t.utils.book_new();t.utils.book_append_sheet(n,o,"Sheet1"),t.writeFile(n,"export.xlsx")}else this.exportToCSV(e),alert("Excel no disponible, exportando como CSV")}catch{this.exportToCSV(e),alert("Error al exportar Excel, exportando como CSV")}}exportToPDF(e){try{let t=window.jspdf?.jsPDF;if(t){let o=new t;if(o.text("Reporte de Datos",20,20),o.autoTable)o.autoTable({head:[e.headers],body:e.rows,startY:30});else{let n=40;e.rows.forEach(r=>{o.text(r.join(" | "),20,n),n+=10})}o.save("export.pdf")}else alert("PDF no disponible, use otra opci\xF3n de exportaci\xF3n")}catch{alert("Error al exportar PDF")}}printData(e){let t=window.open("","","height=600,width=800");if(t){let o=`
        <html>
          <head>
            <title>Reporte</title>
            <style>
              table { border-collapse: collapse; width: 100%; }
              th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
              th { background-color: #f2f2f2; }
            </style>
          </head>
          <body>
            <h2>Reporte de Datos</h2>
            <table>
              <thead>
                <tr>${e.headers.map(n=>`<th>${n}</th>`).join("")}</tr>
              </thead>
              <tbody>
                ${e.rows.map(n=>`<tr>${n.map(r=>`<td>${r}</td>`).join("")}</tr>`).join("")}
              </tbody>
            </table>
          </body>
        </html>
      `;t.document.write(o),t.document.close(),t.print()}}onSelectChange(e,t,o){let r=e.target.value;this.action.emit({action_to_perform:t.field_value+"_change",data:o,value:r})}static \u0275fac=function(t){return new(t||i)(P(z),P(gt),P(mt),P(Ct),P(ot))};static \u0275cmp=M({type:i,selectors:[["app-table"]],inputs:{tableConfig:"tableConfig",hasCheckbox:"hasCheckbox",pageSize:"pageSize",paginateDetails:"paginateDetails",showPaginate:"showPaginate",tableClass:"tableClass",search:"search",pagination:"pagination",selectedRows:"selectedRows",rowDetails:"rowDetails",dateFilter:"dateFilter",initialDateFilter:"initialDateFilter",downloadReports:"downloadReports",searchPlaceholder:"searchPlaceholder",showCopyButton:"showCopyButton",showCsvButton:"showCsvButton",showExcelButton:"showExcelButton",showPdfButton:"showPdfButton",showPrintButton:"showPrintButton",exportButtons:"exportButtons",customButtons:"customButtons"},outputs:{action:"action",customAction:"customAction",dateFilterChange:"dateFilterChange"},features:[tt([O]),U],decls:1,vars:1,consts:[["dp",""],["t",""],[1,"top-body"],[1,"p-3"],[1,"table","table-hover",3,"ngClass"],[1,"bg-light"],[1,"datatable-checkbox",3,"selected-checkbox"],[3,"total","paginate","paginateDetails","selectedRows","selectedItems"],["id","basic-1_filter","search","",1,"dataTables_filter"],[3,"change"],[3,"value","selected"],[1,"row","align-items-center","g-1"],[1,"col-auto"],[1,"form-label"],["id","reportrange","readonly","readonly",1,"range-dropdown","flatpickr-input"],[3,"click"],["id","rangeButtons"],["outsideDays","hidden",3,"dateSelect","displayMonths","dayTemplate"],[1,"custom-day",3,"mouseenter","mouseleave"],["type","text","name","searchTerm",3,"ngModelChange","keyup","ngModel","placeholder"],[1,"dt-buttons","btn-group","flex-wrap"],["type","button",3,"class","title"],[1,"btn-separator","mx-2"],["type","button",3,"click","title"],[3,"class"],["type","button",1,"btn","buttons-copy","buttons-html5","btn-outline-primary"],["type","button",1,"btn","buttons-csv","buttons-html5","btn-outline-primary"],["type","button",1,"btn","buttons-excel","buttons-html5","btn-outline-primary"],["type","button",1,"btn","buttons-pdf","buttons-html5","btn-outline-primary"],["type","button",1,"btn","buttons-print","btn-outline-primary"],["type","button",1,"btn","buttons-copy","buttons-html5","btn-outline-primary",3,"click"],["type","button",1,"btn","buttons-csv","buttons-html5","btn-outline-primary",3,"click"],["type","button",1,"btn","buttons-excel","buttons-html5","btn-outline-primary",3,"click"],["type","button",1,"btn","buttons-pdf","buttons-html5","btn-outline-primary",3,"click"],["type","button",1,"btn","buttons-print","btn-outline-primary",3,"click"],[1,"datatable-checkbox"],["type","checkbox",1,"cb-select-checkbox",3,"change","checked"],[3,"ngClass"],[3,"click","ngClass"],[1,"cb-accending-decending"],[3,"ngStyle"],["data-dt-row","8"],["type","checkbox",3,"change","value","checked"],[3,"click","ngStyle"],[3,"innerHTML"],[1,"form-control","form-select",3,"change","value"],[1,"product-action","common-align","gap-2","justify-content-start"],[1,"btn-sm",3,"title","class"],[1,"btn-sm",3,"click","title"],["colspan","8"],["cellpadding","5","cellspacing","0","border","0",2,"padding-left","50px"],[1,"empty-data"],[3,"setPage","total","paginate","paginateDetails","selectedRows","selectedItems"]],template:function(t,o){t&1&&C(0,Fe,13,8),t&2&&d(o.tableConfig?0:-1)},dependencies:[R,I,at,O,ft,pt,_t,dt,rt,st,ct,lt,bt,ut,ht,j],styles:['@charset "UTF-8";.btn-separator[_ngcontent-%COMP%]{border-left:1px solid #dee2e6;height:32px;align-self:center}.dt-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:5px}.dt-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}.table-actions-section[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;padding:15px 0;border-bottom:1px solid #e9ecef;background-color:#f8f9fa;border-radius:5px}.table-actions-section[_ngcontent-%COMP%]   .dt-buttons[_ngcontent-%COMP%]{gap:5px;flex-wrap:wrap}.table-actions-section[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-bottom:5px}@media (max-width: 768px){.table-actions-section[_ngcontent-%COMP%]{justify-content:center}.table-actions-section[_ngcontent-%COMP%]   .dt-buttons[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.table-actions-section[_ngcontent-%COMP%]   .dt-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin:2px 0;width:100%;max-width:200px}.table-actions-section[_ngcontent-%COMP%]   .dt-buttons[_ngcontent-%COMP%]   .btn-separator[_ngcontent-%COMP%]{display:none}}']})};export{yt as a};
